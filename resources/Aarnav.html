<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>SOHCAHTOA Assessment — 20 Questions (Timed)</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- MathJax (reliable) -->
<script>
  window.MathJax = {
    tex: { inlineMath: [['\\(','\\)']], displayMath: [['\\[','\\]']] }
  };
</script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

<style>
  body{ background:#f3f4f6; }
  .option{ border:2px solid #e5e7eb; padding:12px; border-radius:10px; cursor:pointer; background:#fff; }
  .option:hover{ background:#eff6ff; border-color:#3b82f6; }
  .option.selected{ background:#dbeafe; border-color:#2563eb; font-weight:700; }
  .pill{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
</style>
</head>

<body class="text-gray-800">
<div class="max-w-4xl mx-auto p-6">

  <!-- Header -->
  <div class="bg-white rounded-xl shadow p-5 mb-5 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
    <div>
      <h1 class="text-2xl font-bold">SOHCAHTOA Mastery Quiz</h1>
      <p class="text-sm text-gray-600">20 questions • SOHCAHTOA only • No inverse trig • No word problems</p>
      <p class="text-xs text-gray-500 mt-1">
        Scoring: <span class="pill bg-green-100 text-green-800 px-2 py-0.5 rounded">+4</span> correct,
        <span class="pill bg-red-100 text-red-800 px-2 py-0.5 rounded">-1</span> incorrect,
        <span class="pill bg-gray-200 text-gray-700 px-2 py-0.5 rounded">0</span> skipped
      </p>
    </div>

    <div class="flex items-center gap-3">
      <div id="timer" class="pill text-xl font-bold bg-gray-100 px-4 py-2 rounded-lg border border-gray-200">20:00</div>
      <button id="startBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold px-5 py-2 rounded-lg">
        Start
      </button>
      <button id="submitBtn" class="hidden bg-green-600 hover:bg-green-700 text-white font-bold px-5 py-2 rounded-lg">
        Submit
      </button>
    </div>
  </div>

  <!-- Start screen note -->
  <div id="startScreen" class="bg-white rounded-xl shadow p-5 mb-5">
    <p class="text-sm text-gray-700">
      Click <strong>Start</strong> to begin. The timer starts immediately. The quiz auto-submits at 0:00.
    </p>
  </div>

  <!-- Quiz -->
  <div id="quiz" class="hidden"></div>

  <!-- Results -->
  <div id="results" class="hidden mt-6">
    <div class="bg-white rounded-xl shadow p-5">
      <h2 class="text-xl font-bold mb-2">Results</h2>
      <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mt-3">
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
          <div class="text-xs text-gray-500 uppercase tracking-wide">Score</div>
          <div id="scoreOut" class="text-3xl font-bold mt-1">--</div>
          <div class="text-xs text-gray-500 mt-1">Max: 80 (20×4)</div>
        </div>
        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
          <div class="text-xs text-green-700 uppercase tracking-wide">Correct</div>
          <div id="correctOut" class="text-3xl font-bold text-green-700 mt-1">--</div>
        </div>
        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
          <div class="text-xs text-red-700 uppercase tracking-wide">Incorrect</div>
          <div id="incorrectOut" class="text-3xl font-bold text-red-700 mt-1">--</div>
        </div>
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
          <div class="text-xs text-gray-600 uppercase tracking-wide">Skipped</div>
          <div id="skippedOut" class="text-3xl font-bold text-gray-700 mt-1">--</div>
        </div>
      </div>

      <div class="mt-5">
        <button onclick="location.reload()" class="text-blue-600 hover:underline font-medium">Retake</button>
      </div>
    </div>

    <div class="bg-white rounded-xl shadow mt-5 overflow-hidden">
      <div class="px-5 py-3 bg-gray-50 border-b border-gray-200 flex justify-between items-center">
        <div class="font-semibold">Detailed Scorecard</div>
        <div class="text-xs text-gray-500">Scroll to review</div>
      </div>
      <div id="scorecard" class="divide-y divide-gray-100"></div>
    </div>
  </div>

</div>

<script>
/* ==============================
   Question Bank (20 unique)
   ============================== */
const rawQuestions = [
  { q:"Which ratio equals \\(\\sin(\\theta)\\)?",
    opts:["\\(\\frac{\\text{Opp}}{\\text{Hyp}}\\)","\\(\\frac{\\text{Adj}}{\\text{Hyp}}\\)","\\(\\frac{\\text{Opp}}{\\text{Adj}}\\)","\\(\\frac{\\text{Hyp}}{\\text{Opp}}\\)"],
    correct:"\\(\\frac{\\text{Opp}}{\\text{Hyp}}\\)" },

  { q:"Which ratio equals \\(\\tan(\\theta)\\)?",
    opts:["\\(\\frac{\\text{Adj}}{\\text{Opp}}\\)","\\(\\frac{\\text{Opp}}{\\text{Adj}}\\)","\\(\\frac{\\text{Opp}}{\\text{Hyp}}\\)","\\(\\frac{\\text{Hyp}}{\\text{Adj}}\\)"],
    correct:"\\(\\frac{\\text{Opp}}{\\text{Adj}}\\)" },

  { q:"Opposite \\(=9\\), Hypotenuse \\(=15\\). Find \\(\\sin(\\theta)\\).",
    opts:["\\(\\frac{3}{5}\\)","\\(\\frac{5}{3}\\)","\\(\\frac{9}{15}\\)","\\(\\frac{12}{15}\\)"],
    correct:"\\(\\frac{3}{5}\\)" },

  { q:"Adjacent \\(=8\\), Hypotenuse \\(=17\\). Find \\(\\cos(\\theta)\\).",
    opts:["\\(\\frac{15}{17}\\)","\\(\\frac{8}{17}\\)","\\(\\frac{8}{15}\\)","\\(\\frac{17}{8}\\)"],
    correct:"\\(\\frac{8}{17}\\)" },

  { q:"Opposite \\(=5\\), Adjacent \\(=12\\). Find \\(\\tan(\\theta)\\).",
    opts:["\\(\\frac{5}{12}\\)","\\(\\frac{12}{5}\\)","\\(\\frac{13}{12}\\)","\\(\\frac{5}{13}\\)"],
    correct:"\\(\\frac{5}{12}\\)" },

  { q:"If \\(\\sin(\\theta)=\\frac{7}{25}\\), and Hypotenuse \\(=25\\), what is the Adjacent side?",
    opts:["24","18","7","25"],
    correct:"24" },

  { q:"If \\(\\cos(\\theta)=\\frac{12}{13}\\), and Hypotenuse \\(=13\\), what is the Opposite side?",
    opts:["5","12","13","\\(\\sqrt{13}\\)"],
    correct:"5" },

  { q:"If \\(\\tan(\\theta)=\\frac{9}{12}\\), find \\(\\sin(\\theta)\\).",
    opts:["\\(\\frac{3}{5}\\)","\\(\\frac{4}{5}\\)","\\(\\frac{9}{15}\\)","\\(\\frac{12}{15}\\)"],
    correct:"\\(\\frac{3}{5}\\)" },

  { q:"If \\(\\tan(\\theta)=1\\), what is \\(\\cos(\\theta)\\)?",
    opts:["\\(\\frac{\\sqrt2}{2}\\)","\\(\\frac{1}{2}\\)","1","\\(\\frac{\\sqrt3}{2}\\)"],
    correct:"\\(\\frac{\\sqrt2}{2}\\)" },

  { q:"Right triangle with legs 6 and 8 (hypotenuse 10). Find \\(\\sin(\\theta)\\) where \\(\\theta\\) is opposite 6.",
    opts:["\\(\\frac{3}{5}\\)","\\(\\frac{4}{5}\\)","\\(\\frac{6}{10}\\)","\\(\\frac{8}{10}\\)"],
    correct:"\\(\\frac{3}{5}\\)" },

  { q:"Same triangle (legs 6 and 8, hypotenuse 10). Find \\(\\cos(\\theta)\\) where \\(\\theta\\) is opposite 6.",
    opts:["\\(\\frac{4}{5}\\)","\\(\\frac{3}{5}\\)","\\(\\frac{6}{10}\\)","\\(\\frac{8}{10}\\)"],
    correct:"\\(\\frac{4}{5}\\)" },

  { q:"If \\(\\sin(\\theta)=\\frac{4}{5}\\), find \\(\\tan(\\theta)\\).",
    opts:["\\(\\frac{4}{3}\\)","\\(\\frac{3}{4}\\)","\\(\\frac{5}{4}\\)","\\(\\frac{4}{5}\\)"],
    correct:"\\(\\frac{4}{3}\\)" },

  { q:"In right \\(\\triangle ABC\\) with \\(\\angle C=90^\\circ\\). If side \\(b\\) is adjacent to \\(\\angle A\\) and \\(c\\) is the hypotenuse, which is \\(\\cos(A)\\)?",
    opts:["\\(\\frac{b}{c}\\)","\\(\\frac{c}{b}\\)","\\(\\frac{a}{b}\\)","\\(\\frac{a}{c}\\)"],
    correct:"\\(\\frac{b}{c}\\)" },

  { q:"If \\(\\sin(\\theta)=\\frac{5}{13}\\), find \\(\\cos(\\theta)\\).",
    opts:["\\(\\frac{12}{13}\\)","\\(\\frac{5}{12}\\)","\\(\\frac{5}{13}\\)","\\(\\frac{13}{12}\\)"],
    correct:"\\(\\frac{12}{13}\\)" },

  { q:"Which ratio equals \\(\\csc(\\theta)\\)?",
    opts:["\\(\\frac{\\text{Hyp}}{\\text{Opp}}\\)","\\(\\frac{\\text{Opp}}{\\text{Hyp}}\\)","\\(\\frac{\\text{Hyp}}{\\text{Adj}}\\)","\\(\\frac{\\text{Adj}}{\\text{Opp}}\\)"],
    correct:"\\(\\frac{\\text{Hyp}}{\\text{Opp}}\\)" },

  { q:"Which ratio equals \\(\\sec(\\theta)\\)?",
    opts:["\\(\\frac{\\text{Hyp}}{\\text{Adj}}\\)","\\(\\frac{\\text{Adj}}{\\text{Hyp}}\\)","\\(\\frac{\\text{Opp}}{\\text{Hyp}}\\)","\\(\\frac{\\text{Adj}}{\\text{Opp}}\\)"],
    correct:"\\(\\frac{\\text{Hyp}}{\\text{Adj}}\\)" },

  { q:"Which ratio equals \\(\\cot(\\theta)\\)?",
    opts:["\\(\\frac{\\text{Adj}}{\\text{Opp}}\\)","\\(\\frac{\\text{Opp}}{\\text{Adj}}\\)","\\(\\frac{\\text{Hyp}}{\\text{Adj}}\\)","\\(\\frac{\\text{Hyp}}{\\text{Opp}}\\)"],
    correct:"\\(\\frac{\\text{Adj}}{\\text{Opp}}\\)" },

  { q:"If \\(\\sin(A)=\\frac{8}{17}\\), find \\(\\tan(A)\\).",
    opts:["\\(\\frac{8}{15}\\)","\\(\\frac{15}{8}\\)","\\(\\frac{8}{17}\\)","\\(\\frac{15}{17}\\)"],
    correct:"\\(\\frac{8}{15}\\)" },

  { q:"In a right triangle, Adjacent \\(=9\\), Hypotenuse \\(=15\\). Find \\(\\sec(\\theta)\\).",
    opts:["\\(\\frac{5}{3}\\)","\\(\\frac{3}{5}\\)","\\(\\frac{9}{15}\\)","\\(\\frac{15}{9}\\)"],
    correct:"\\(\\frac{5}{3}\\)" },

  { q:"In a right triangle, Opposite \\(=12\\), Hypotenuse \\(=13\\). Find \\(\\csc(\\theta)\\).",
    opts:["\\(\\frac{13}{12}\\)","\\(\\frac{12}{13}\\)","\\(\\frac{5}{13}\\)","\\(\\frac{13}{5}\\)"],
    correct:"\\(\\frac{13}{12}\\)" }
];

/* ==============================
   Quiz Engine
   ============================== */
const SCORING = { correct: 4, incorrect: -1, skipped: 0 };
const TIME_LIMIT_SEC = 20 * 60;

let questions = [];
let answers = [];
let timeLeft = TIME_LIMIT_SEC;
let timerId = null;
let started = false;

function shuffleArray(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

function buildQuestions(){
  // deep-copy + scramble options per question
  questions = rawQuestions.map(q => {
    const opts = q.opts.slice();
    shuffleArray(opts);
    return {
      text: q.q,
      options: opts,
      correctText: q.correct,
      correctIndex: opts.indexOf(q.correct)
    };
  });
  answers = new Array(questions.length).fill(null);
}

function fmtTime(s){
  const m = Math.floor(s/60);
  const r = s%60;
  return `${String(m).padStart(2,'0')}:${String(r).padStart(2,'0')}`;
}

function renderQuiz(){
  const quizDiv = document.getElementById('quiz');
  quizDiv.innerHTML = '';

  questions.forEach((q, i) => {
    const card = document.createElement('div');
    card.className = "bg-white rounded-xl shadow p-5 mb-4";

    const header = document.createElement('div');
    header.className = "flex items-center justify-between gap-3 mb-3";
    header.innerHTML = `
      <div class="font-bold text-gray-700">Question ${i+1}</div>
      <button class="text-xs text-red-600 hover:underline" onclick="clearAnswer(${i})">Clear</button>
    `;

    const prompt = document.createElement('div');
    prompt.className = "text-base md:text-lg font-medium leading-relaxed mb-3";
    prompt.innerHTML = q.text;

    const grid = document.createElement('div');
    grid.className = "grid grid-cols-1 md:grid-cols-2 gap-3";
    grid.id = `opt-${i}`;

    q.options.forEach((opt, j) => {
      const optDiv = document.createElement('div');
      optDiv.className = "option";
      optDiv.innerHTML = opt;
      optDiv.onclick = () => selectOption(i, j);
      grid.appendChild(optDiv);
    });

    card.appendChild(header);
    card.appendChild(prompt);
    card.appendChild(grid);
    quizDiv.appendChild(card);
  });

  // typeset after DOM injection
  if (window.MathJax && MathJax.typesetPromise) {
    MathJax.typesetPromise();
  }
}

function selectOption(qIndex, optIndex){
  answers[qIndex] = optIndex;
  const grid = document.getElementById(`opt-${qIndex}`);
  [...grid.querySelectorAll('.option')].forEach((el, idx) => {
    el.classList.toggle('selected', idx === optIndex);
  });
}

function clearAnswer(qIndex){
  answers[qIndex] = null;
  const grid = document.getElementById(`opt-${qIndex}`);
  [...grid.querySelectorAll('.option')].forEach(el => el.classList.remove('selected'));
}

function startTimer(){
  const timerEl = document.getElementById('timer');
  timerEl.textContent = fmtTime(timeLeft);

  timerId = setInterval(() => {
    timeLeft--;
    timerEl.textContent = fmtTime(timeLeft);

    if (timeLeft <= 60) {
      timerEl.classList.add('text-red-600');
    }

    if (timeLeft <= 0) {
      submit(true);
    }
  }, 1000);
}

function submit(auto=false){
  if (!started) return;
  started = false;
  clearInterval(timerId);

  document.getElementById('submitBtn').classList.add('hidden');
  document.getElementById('startBtn').classList.add('hidden');
  document.getElementById('quiz').classList.add('hidden');
  document.getElementById('startScreen').classList.add('hidden');
  document.getElementById('results').classList.remove('hidden');

  let score = 0, correct = 0, incorrect = 0, skipped = 0;

  const scorecard = document.getElementById('scorecard');
  scorecard.innerHTML = '';

  questions.forEach((q, i) => {
    const user = answers[i];
    let pts = 0;
    let status = 'Skipped';
    let rowClass = 'bg-gray-50';

    if (user === null) {
      skipped++;
      pts = SCORING.skipped;
    } else if (user === q.correctIndex) {
      correct++;
      pts = SCORING.correct;
      score += pts;
      status = 'Correct';
      rowClass = 'bg-green-50';
    } else {
      incorrect++;
      pts = SCORING.incorrect;
      score += pts;
      status = 'Incorrect';
      rowClass = 'bg-red-50';
    }

    const row = document.createElement('div');
    row.className = `p-4 ${rowClass}`;
    row.innerHTML = `
      <div class="flex justify-between items-center mb-2">
        <div class="font-bold text-gray-700">Q${i+1} <span class="text-xs font-normal text-gray-500">(${status})</span></div>
        <div class="pill font-bold ${pts>0?'text-green-700':(pts<0?'text-red-700':'text-gray-600')}">
          ${pts>0?'+':''}${pts}
        </div>
      </div>
      <div class="text-sm text-gray-800 mb-2">${q.text}</div>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm">
        <div class="bg-white border border-gray-200 rounded p-2">
          <div class="text-xs text-gray-500">Your Answer</div>
          <div class="font-medium ${status==='Correct'?'text-green-700':(status==='Incorrect'?'text-red-700':'text-gray-500')}">
            ${user===null?'Skipped':q.options[user]}
          </div>
        </div>
        <div class="bg-white border border-gray-200 rounded p-2">
          <div class="text-xs text-gray-500">Correct Answer</div>
          <div class="font-medium text-gray-900">${q.correctText}</div>
        </div>
      </div>
    `;
    scorecard.appendChild(row);
  });

  document.getElementById('scoreOut').textContent = score;
  document.getElementById('correctOut').textContent = correct;
  document.getElementById('incorrectOut').textContent = incorrect;
  document.getElementById('skippedOut').textContent = skipped;

  if (window.MathJax && MathJax.typesetPromise) {
    MathJax.typesetPromise();
  }

  window.scrollTo(0,0);
}

function start(){
  if (started) return;
  started = true;

  buildQuestions();
  renderQuiz();

  document.getElementById('startScreen').classList.add('hidden');
  document.getElementById('quiz').classList.remove('hidden');
  document.getElementById('submitBtn').classList.remove('hidden');
  document.getElementById('startBtn').classList.add('hidden');

  timeLeft = TIME_LIMIT_SEC;
  startTimer();
}

/* Wire buttons */
document.getElementById('startBtn').addEventListener('click', start);
document.getElementById('submitBtn').addEventListener('click', () => submit(false));

/* Initial timer display */
document.getElementById('timer').textContent = fmtTime(TIME_LIMIT_SEC);
</script>
</body>
</html>
