<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parallelogram Proficiency: Hard Mode</title>
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #2c3e50;
            --accent: #b03a2e; /* Dark Red for Hard Mode */
            --success: #1e8449;
            --bg: #f4f6f7;
            --card-bg: #ffffff;
            --text: #34495e;
        }
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        /* Start Screen */
        #start-screen {
            text-align: center;
            background: white;
            padding: 50px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: 50px;
        }
        #start-screen h1 { color: var(--primary); margin-bottom: 10px; }
        #start-screen p { font-size: 1.1em; color: #666; margin-bottom: 30px; }

        /* Quiz Content (Hidden Initially) */
        #quiz-content { display: none; }

        /* Sticky Header */
        .sticky-header {
            position: sticky;
            top: 10px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(5px);
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
        }

        .timer-box {
            font-weight: 800;
            font-size: 1.4em;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quiz-title {
            font-size: 1.2em;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
        }

        /* Question Cards */
        .question-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.03);
            border-left: 6px solid transparent;
            transition: all 0.3s ease;
        }
        
        .q-header {
            font-weight: 600;
            font-size: 1.15em;
            margin-bottom: 20px;
            color: var(--primary);
        }
        .q-num { color: var(--accent); margin-right: 10px; font-weight: 800; }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        @media(max-width: 600px) { .options-grid { grid-template-columns: 1fr; } }

        .option-label {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            background: #fff;
        }
        .option-label:hover { border-color: var(--primary); background: #f8f9fa; }
        
        input[type="radio"] { margin-right: 12px; transform: scale(1.2); accent-color: var(--accent); }

        /* Score Modal */
        #score-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .score-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .score-circle {
            width: 120px;
            height: 120px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5em;
            font-weight: bold;
            margin: 0 auto 20px;
            border: 5px solid var(--accent);
        }

        .feedback {
            margin-top: 15px;
            padding: 10px 15px;
            border-radius: 6px;
            display: none;
            font-weight: bold;
        }
        .feedback.correct { background: #d5f5e3; color: #196f3d; }
        .feedback.incorrect { background: #fadbd8; color: #943126; }

        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(176, 58, 46, 0.3);
            transition: transform 0.2s;
        }
        .btn:hover { transform: translateY(-2px); background: #922b21; }
        .btn-large { font-size: 1.3em; padding: 20px 60px; }
        .btn-close { background: #7f8c8d; margin-top: 10px; box-shadow: none; width: 100%; }
    </style>
</head>
<body>

<div class="container">
    
    <div id="start-screen">
        <h1>Parallelograms: Hard Mode</h1>
        <p>20 Advanced Questions | 30 Minutes</p>
        <p>Prepare for systems of equations, quadratics, and coordinate geometry.</p>
        <button class="btn btn-large" onclick="beginQuiz()">Start Quiz</button>
    </div>

    <div id="quiz-content">
        <div class="sticky-header">
            <div class="quiz-title">Level II Assessment</div>
            <div class="timer-box">
                <span>‚è±</span>
                <span id="time-display">30:00</span>
            </div>
        </div>

        <div id="quiz-area"></div>

        <div style="text-align: center; margin-top: 40px;">
            <button class="btn" onclick="submitQuiz()" id="submit-btn">Submit & Stop Timer</button>
        </div>
    </div>

</div>

<div id="score-modal">
    <div class="score-content">
        <div class="score-circle" id="final-score">0%</div>
        <h2 id="score-title">Assessment Complete</h2>
        <p>Review your results below.</p>
        <div style="margin: 20px 0; font-size: 0.9em; color: #666;">
            Time Taken: <span id="time-taken" style="font-weight:bold; color:var(--primary)">00:00</span>
        </div>
        <button class="btn btn-close" onclick="closeModal()">Check Errors</button>
        <button class="btn" onclick="location.reload()" style="margin-top:10px; background-color: var(--primary);">Retake Quiz</button>
    </div>
</div>

<script>
    // Questions using LaTeX syntax for MathJax
    const questions = [
        {
            q: "In parallelogram \\(ABCD\\), \\(AB = 2x + y\\) and \\(CD = 12\\). Side \\(BC = x + 2y\\) and \\(AD = 9\\). Find the values of \\(x\\) and \\(y\\).",
            options: ["\\(x=3, y=6\\)", "\\(x=5, y=2\\)", "\\(x=4, y=3\\)", "\\(x=2, y=5\\)"],
            correct: 1
        },
        {
            q: "In parallelogram \\(PQRS\\), \\(m\\angle P = x^2\\) and \\(m\\angle R = 8x + 20\\). Find the measure of \\(\\angle P\\).",
            options: ["\\(100^\\circ\\)", "\\(10^\\circ\\)", "\\(4^\\circ\\)", "\\(120^\\circ\\)"],
            correct: 0
        },
        {
            q: "Two consecutive angles of a parallelogram are in the ratio \\(3:7\\). What is the difference between these two angles?",
            options: ["\\(72^\\circ\\)", "\\(54^\\circ\\)", "\\(126^\\circ\\)", "\\(108^\\circ\\)"],
            correct: 0
        },
        {
            q: "The perimeter of a parallelogram is 54 cm. One side is 3 cm longer than twice the other side. Find the length of the longer side.",
            options: ["8 cm", "16 cm", "19 cm", "27 cm"],
            correct: 2
        },
        {
            q: "Diagonals intersect at \\(E\\). \\(AE = 2x - y\\), \\(EC = 8\\), \\(DE = x + y\\), \\(EB = 13\\). Find \\(x\\).",
            options: ["7", "5", "6", "8"],
            correct: 0
        },
        {
            q: "Vertices of a parallelogram are \\(A(1,1)\\), \\(B(5,3)\\), and \\(C(7,7)\\). Find the coordinates of vertex \\(D\\).",
            options: ["\\((3, 5)\\)", "\\((11, 9)\\)", "\\((3, 6)\\)", "\\((2, 5)\\)"],
            correct: 0
        },
        {
            q: "An exterior angle of a parallelogram is \\(3x - 10\\). The adjacent interior angle is \\(2x + 40\\). Find the measure of the **opposite** interior angle.",
            options: ["\\(30^\\circ\\)", "\\(100^\\circ\\)", "\\(80^\\circ\\)", "\\(150^\\circ\\)"],
            correct: 1
        },
        {
            q: "In parallelogram \\(WXYZ\\), diagonal \\(WY\\) has length 24. Segment \\(WM\\) (where M is the intersection) is defined by \\(x^2 - x\\). Find the positive integer \\(x\\).",
            options: ["4", "3", "5", "6"],
            correct: 0
        },
        {
            q: "Side \\(AB = 4n + 3\\) and \\(CD = 3n + 8\\). Side \\(BC = n^2\\). Find the perimeter of the parallelogram.",
            options: ["58", "46", "96", "98"],
            correct: 2
        },
        {
            q: "In \\(ABCD\\), \\(m\\angle A = x + 3y\\) and \\(m\\angle C = 110\\). If \\(m\\angle B = 2x + y\\), find \\(x\\) and \\(y\\).",
            options: ["\\(x=20, y=30\\)", "\\(x=10, y=40\\)", "\\(x=14, y=32\\)", "\\(x=30, y=20\\)"],
            correct: 0
        },
        {
            q: "The bisector of \\(\\angle A\\) in parallelogram \\(ABCD\\) intersects side \\(CD\\) at point \\(E\\). If \\(DE = 8\\) and \\(EC = 4\\), find the perimeter.",
            options: ["40", "24", "32", "20"],
            correct: 0
        },
        {
            q: "Find the coordinates of the intersection of the diagonals of a parallelogram with vertices \\(P(0,0), Q(6,0), R(8,5), S(2,5)\\).",
            options: ["\\((4, 2.5)\\)", "\\((3, 2.5)\\)", "\\((4, 3)\\)", "\\((5, 2.5)\\)"],
            correct: 0
        },
        {
            q: "If the perimeter is \\(30x\\) and the adjacent sides are \\(4x + 5\\) and \\(6x + 5\\), find \\(x\\).",
            options: ["2", "5", "10", "4"],
            correct: 0
        },
        {
            q: "Sum of three angles of a parallelogram is \\(260^\\circ\\). Find the measure of the smallest angle.",
            options: ["\\(100^\\circ\\)", "\\(80^\\circ\\)", "\\(50^\\circ\\)", "\\(130^\\circ\\)"],
            correct: 1
        },
        {
            q: "In parallelogram \\(ABCD\\), \\(AC = 4x - 2\\) and \\(BD = 3x + 4\\). If the diagonals intersect at \\(E\\), and \\(BE = 11\\), find \\(AC\\).",
            options: ["22", "18", "24", "11"],
            correct: 0
        },
        {
            q: "Side \\(AB = x^2\\) and side \\(CD = 3x + 18\\). Find the value of \\(x\\) (given \\(x > 0\\)).",
            options: ["6", "3", "9", "4"],
            correct: 0
        },
        {
            q: "\\(m\\angle A = x\\) and \\(m\\angle B = 3x + 20\\). Find \\(m\\angle D\\).",
            options: ["\\(40^\\circ\\)", "\\(140^\\circ\\)", "\\(120^\\circ\\)", "\\(60^\\circ\\)"],
            correct: 1
        },
        {
            q: "Opposite sides are \\(3x - 4\\) and \\(x + 6\\). The adjacent side is \\(y\\). If the perimeter is 40, find \\(y\\).",
            options: ["9", "11", "22", "5"],
            correct: 0
        },
        {
            q: "In parallelogram \\(ABCD\\), \\(m\\angle A = 2x - 10\\) and \\(m\\angle C = x + 30\\). Find the measure of the exterior angle at \\(D\\).",
            options: ["\\(70^\\circ\\)", "\\(110^\\circ\\)", "\\(80^\\circ\\)", "\\(100^\\circ\\)"],
            correct: 0
        },
        {
            q: "Two diagonals have lengths \\(10x\\) and \\(8x + 6\\). They intersect at \\(M\\). If \\(AM = 15\\), find \\(x\\) (assuming \\(10x\\) is the length of diagonal \\(AC\\)).",
            options: ["3", "4", "5", "6"],
            correct: 0
        }
    ];

    let timeLeft = 30 * 60; // 30 minutes
    let timerId;

    function formatTime(seconds) {
        const m = Math.floor(seconds / 60);
        const s = seconds % 60;
        return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }

    function beginQuiz() {
        // Hide start screen, show quiz content
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('quiz-content').style.display = 'block';
        
        // Initialize Questions and Timer
        renderQuiz();
        startTimer();
    }

    function startTimer() {
        const display = document.getElementById('time-display');
        display.textContent = "30:00"; // Reset text
        
        timerId = setInterval(() => {
            timeLeft--;
            display.textContent = formatTime(timeLeft);
            
            if(timeLeft <= 0) {
                clearInterval(timerId);
                submitQuiz(true);
            }
            if(timeLeft < 300) display.style.color = 'red';
        }, 1000);
    }

    function renderQuiz() {
        const quizArea = document.getElementById('quiz-area');
        questions.forEach((qObj, index) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `card-${index}`;
            card.innerHTML = `
                <div class="q-header">
                    <span class="q-num">Q${index + 1}.</span> ${qObj.q}
                </div>
                <div class="options-grid">
                    ${qObj.options.map((opt, i) => `
                        <label class="option-label" id="label-${index}-${i}">
                            <input type="radio" name="q${index}" value="${i}">
                            <span style="font-size:0.95em;">${opt}</span>
                        </label>
                    `).join('')}
                </div>
                <div class="feedback" id="feedback-${index}"></div>
            `;
            quizArea.appendChild(card);
        });

        // Trigger MathJax to render the new content
        if (window.MathJax) {
            MathJax.typesetPromise();
        }
    }

    function submitQuiz() {
        clearInterval(timerId);
        document.getElementById('submit-btn').style.display = 'none';
        
        let score = 0;
        const total = questions.length;

        questions.forEach((qObj, index) => {
            const selected = document.querySelector(`input[name="q${index}"]:checked`);
            const feedbackEl = document.getElementById(`feedback-${index}`);
            const inputs = document.getElementsByName(`q${index}`);
            
            inputs.forEach(inp => inp.disabled = true);

            feedbackEl.className = 'feedback';
            feedbackEl.style.display = 'block';

            if(selected && parseInt(selected.value) === qObj.correct) {
                score++;
                feedbackEl.classList.add('correct');
                feedbackEl.innerHTML = `Correct!`;
            } else {
                feedbackEl.classList.add('incorrect');
                feedbackEl.innerHTML = `Incorrect.`;
            }
        });

        // Score Card Logic
        const percentage = Math.round((score / total) * 100);
        document.getElementById('final-score').innerText = `${percentage}%`;
        
        // Time Taken
        const timeTakenSec = (30 * 60) - timeLeft;
        document.getElementById('time-taken').innerText = formatTime(timeTakenSec);

        document.getElementById('score-modal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('score-modal').style.display = 'none';
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>

</body>
</html>
