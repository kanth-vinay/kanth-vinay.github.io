<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chapter 9 — Hypothesis Tests for One Population Mean — Prof. Kodipelly</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Reveal core -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/reveal.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/theme/white.min.css" id="theme-link">

  <!-- Menu plugin -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/menu.css">

  <style>
    :root{
      --brand-primary:#00539C; --brand-secondary:#00325C;
      --accent-green:#2E7D32; --accent-orange:#EF6C00; --accent-red:#C62828;
      --text-primary:#111827; --text-secondary:#4B5563;
      --bg-primary:#FFFFFF; --bg-secondary:#F4F6F8; --border-color:#D1D5DB;
      --shadow-md:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    }
    [data-theme="dark"]{
      --brand-primary:#5DCD4; --brand-secondary:#8BB8E8;
      --accent-green:#66BB6A; --accent-orange:#FFA726; --accent-red:#E57373;
      --text-primary:#F9FAFB; --text-secondary:#9CA3AF;
      --bg-primary:#111827; --bg-secondary:#1F2937; --border-color:#374151;
    }

    body{ font-family:'Inter',system-ui,sans-serif; color:var(--text-primary); background:var(--bg-primary); }

    #page-header,#page-footer{ position:fixed; left:0; right:0; z-index:1000; background:var(--brand-primary); color:#fff; display:flex; align-items:center; justify-content:space-between; padding:0 20px; box-shadow:var(--shadow-md); font-family:'Poppins', sans-serif; }
    #page-header{ top:0; height:64px; }
    #page-footer{ bottom:0; height:40px; font-size:.85em; }
    #page-header .author{ font-weight:700; font-size:1.1em; }
    #page-header .topic{ font-weight:500; opacity:.95; }
    #page-header .controls{ display:flex; gap:12px; align-items:center; }
    #page-footer .hints{ opacity:.85; }
    .theme-toggle{ background:none; border:1px solid #fff4; color:#fff; border-radius:999px; padding:6px 10px; cursor:pointer; font-weight:600; }

    .reveal{ margin-top:64px; margin-bottom:40px; font-size:26px; }
    .reveal .slides{ color:var(--text-primary); }
    /* FIX: Vertically center slide content */
    .reveal .slides section{ display:flex; flex-direction:column; justify-content:center; height:100%; padding:1vh 0; }
    .reveal h2{ font-family:'Poppins', sans-serif; color:var(--brand-secondary); font-size:1.5em; margin-bottom:20px; }
    .reveal h3{ font-family:'Poppins', sans-serif; font-size:1.0em; font-weight:600; margin-bottom:15px; }
    .reveal p,.reveal li{ line-height:1.6; }
    .left-align{ text-align:left; max-width:950px; margin:0 auto; }

    .small{ font-size:.75em; color:var(--text-secondary); }

    .callout{ border-left:4px solid var(--accent-orange); background:var(--bg-secondary); padding:16px 20px; border-radius:8px; border:1px solid var(--border-color); margin:1em auto; max-width: 950px; }

    .card{ perspective:1200px; width:min(900px,90vw); margin:16px auto; cursor:pointer; }
    .card-inner{ position:relative; width:100%; min-height:180px; transition:transform .6s; transform-style:preserve-3d; }
    .card.flipped .card-inner{ transform:rotateY(180deg); }
    .card-face{ position:absolute; inset:0; display:flex; flex-direction: column; align-items:center; justify-content:center; backface-visibility:hidden; border-radius:10px; border:1px solid var(--border-color); padding:20px; background:var(--bg-primary); box-shadow:var(--shadow-md); text-align:center; }
    .card-face.front{ background:var(--bg-secondary); }
    .card-face.back{ transform:rotateY(180deg); text-align:left; font-size:.9em; justify-content:flex-start; }

    .interactive-tool { background: var(--bg-secondary); padding: 20px; border-radius: 12px; border: 1px solid var(--border-color); max-width: 1000px; margin: 15px auto; font-size: 0.8em; }
    .tool-controls { display: flex; align-items: center; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 15px; }
    .tool-controls label { font-weight: 500; display:flex; align-items:center; gap: 5px;}
    .tool-controls input[type="number"]{ width: 110px; padding: 6px 8px; border:1px solid var(--border-color); border-radius:8px; background:var(--bg-primary); color:var(--text-primary); }
    .tool-controls select, .tool-controls button{ padding: 8px 10px; border-radius:8px; border:1px solid var(--border-color); background:var(--bg-primary); color:var(--text-primary); cursor:pointer; }
    .tool-controls button.primary{ background: var(--brand-primary); color:#fff; border-color: transparent; }
    .tool-canvas { width: 100%; height: 250px; display: block; }
    .pill { display:inline-block; padding:4px 10px; border-radius:999px; border:1px solid var(--border-color); background:var(--bg-primary); font-size:.8em; }

    .mind-map { display:flex; justify-content:space-around; align-items:center; width:100%; max-width:1100px; margin:auto; font-size:.7em; }
    .map-step { display:flex; flex-direction:column; align-items:center; text-align:center; padding:10px; border:2px solid transparent; border-radius:10px; transition:all .3s; }
    .map-step .step-number { font-weight:bold; background-color:var(--text-secondary); color:var(--bg-primary); width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-bottom:10px; }
    .map-step.active { border-color:var(--accent-orange); background-color:var(--bg-secondary); transform:scale(1.05); }
    .map-step.active .step-number { background-color:var(--accent-orange); }
    .map-arrow { font-size:2em; color:var(--border-color); }

    .quiz-choice { padding:10px 12px; border:1px solid var(--border-color); border-radius:10px; margin:6px 0; cursor:pointer; }
    .quiz-choice.correct { border-color:#16a34a; background:#ecfdf5; }
    .quiz-choice.incorrect { border-color:#dc2626; background:#fee2e2; }
    .muted { color: var(--text-secondary); }
    .kbd{ padding:2px 6px; border:1px solid var(--border-color); border-radius:6px; font-family:ui-monospace, SFMono-Regular, Menlo, monospace; font-size:.8em; }
  </style>
</head>
<body>
  <header id="page-header"><div class="author">Prof. Vinay Kanth Rao Kodipelly</div><div class="topic" id="topic-slot">Hypothesis Testing</div><div class="controls"><button class="theme-toggle" id="theme-toggle">Theme</button></div></header>
  <footer id="page-footer"><div class="brand">University of Missouri–St. Louis</div><div class="hints">←/→ • F • S • <span class="kbd">M</span> menu</div></footer>

  <div class="reveal">
    <div class="slides">
      <!-- Title -->
      <section data-menu="title" data-topic="Hypothesis Tests">
        <h2>Hypothesis Tests for One Population Mean</h2>
        <h3 class="muted">A Structured Method for Making Decisions with Data</h3>
      </section>

      <!-- Roadmap -->
      <section data-menu="mindmap-intro" data-topic="The Process">
        <h2>Our Roadmap: The 5 Steps of Hypothesis Testing</h2>
        <p class="small">We will follow this process for every test. Don't worry, we'll break down each step.</p>
        <div class="mind-map">
          <div class="map-step active"><div class="step-number">1</div>State Hypotheses</div>
          <div class="map-arrow">→</div>
          <div class="map-step"><div class="step-number">2</div>Set Significance</div>
          <div class="map-arrow">→</div>
          <div class="map-step"><div class="step-number">3</div>Compute Test Statistic</div>
          <div class="map-arrow">→</div>
          <div class="map-step"><div class="step-number">4</div>Make Decision</div>
          <div class="map-arrow">→</div>
          <div class="map-step"><div class="step-number">5</div>State Conclusion</div>
        </div>
      </section>

      <!-- Courtroom analogy -->
      <section data-menu="courtroom" data-topic="The Core Idea">
        <h2>The Courtroom Analogy</h2>
        <p>A hypothesis test is like a criminal trial.</p>
        <div class="left-align" style="display: flex; gap: 20px; align-items: center;">
          <div style="flex: 1;">
            <p><strong>The Null Hypothesis (\(H_0\)):</strong></p>
            <h3 style="color:var(--brand-primary);">"The defendant is innocent."</h3>
            <p>This is the default assumption. We need <strong>strong evidence</strong> to reject it.</p>
          </div>
          <div style="flex: 1;" class="fragment">
            <p><strong>The Alternative Hypothesis (\(H_a\)):</strong></p>
            <h3 style="color:var(--accent-red);">"The defendant is guilty."</h3>
            <p>This is what the prosecutor tries to prove. It requires evidence "beyond a reasonable doubt."</p>
          </div>
        </div>
      </section>

      <!-- Type I / II -->
      <section data-menu="errors" data-topic="Errors in Testing">
        <h2>Two Ways to Be Wrong</h2>
        <div class="left-align" style="display: flex; gap: 20px; align-items: center;">
          <div style="flex: 1; text-align:center;">
            <h3>Type I Error (\(\alpha\))</h3>
            <p><strong>Convicting an innocent person.</strong></p>
            <p class="fragment">We reject \(H_0\) when it was actually true.</p>
            <p class="small fragment">The probability of this is the <strong>significance level (\(\alpha\))</strong>, our "reasonable doubt" threshold.</p>
          </div>
          <div style="flex: 1; text-align:center;" class="fragment">
            <h3>Type II Error (\(\beta\))</h3>
            <p><strong>Letting a guilty person go free.</strong></p>
            <p class="fragment">We fail to reject \(H_0\) when it was actually false.</p>
            <p class="small fragment">The probability of correctly rejecting a false \(H_0\) is called <strong>Power</strong> (\(1-\beta\)).</p>
          </div>
        </div>
      </section>

      <!-- Step 1 -->
      <section data-menu="mindmap-step1" data-topic="Step 1: Hypotheses">
        <h2>Step 1: State the Hypotheses</h2>
        <div class="mind-map"><div class="map-step active"><div class="step-number">1</div>State Hypotheses</div><div class="map-arrow">→</div>...</div>
        <div class="left-align">
          <p>The <strong>null hypothesis (\(H_0\))</strong> always contains equality (=).</p>
          <p>The <strong>alternative hypothesis (\(H_a\))</strong> states what you are trying to find evidence for (<, >, or ≠).</p>
          <div class="fragment" style="display:flex; gap:10px; justify-content:center; text-align:center;">
              <div><strong>Two-Tailed</strong><br>\(H_a: \mu \neq \mu_0\)</div>
              <div><strong>Left-Tailed</strong><br>\(H_a: \mu < \mu_0\)</div>
              <div><strong>Right-Tailed</strong><br>\(H_a: \mu > \mu_0\)</div>
          </div>
        </div>
      </section>

      <!-- Step 2 -->
      <section data-menu="mindmap-step2" data-topic="Step 2: Significance">
        <h2>Step 2: Set the Significance Level (\(\alpha\))</h2>
        <div class="mind-map">...<div class="map-arrow">→</div><div class="map-step active"><div class="step-number">2</div>Set Significance</div><div class="map-arrow">→</div>...</div>
        <div class="left-align">
            <p>\(\alpha\) is the maximum acceptable probability of making a Type I error.</p>
            <p>Think of it as the "reasonable doubt" standard. Common choices are <strong>0.05</strong>, <strong>0.01</strong>, and <strong>0.10</strong>.</p>
            <p class="fragment">If \(\alpha = 0.05\), we are saying we're willing to take a 5% risk of incorrectly rejecting the null hypothesis.</p>
        </div>
      </section>

      <!-- Step 3 -->
      <section data-menu="mindmap-step3" data-topic="Step 3: Test Statistic">
        <h2>Step 3: Compute the Test Statistic</h2>
        <div class="mind-map">...<div class="map-arrow">→</div><div class="map-step active"><div class="step-number">3</div>Compute Test Statistic</div><div class="map-arrow">→</div>...</div>
        <div class="left-align">
            <p>The test statistic measures how many standard errors your sample mean (\(\bar{x}\)) is from the hypothesized mean (\(\mu_0\)).</p>
            <div style="display:flex; justify-content: space-around;">
              <div>
                <h3 style="color:var(--brand-primary);">z-test (if \(\sigma\) is known)</h3>
                \[ z = \frac{\bar{x} - \mu_0}{\sigma/\sqrt{n}} \]
              </div>
              <div class="fragment">
                <h3 style="color:var(--accent-green);">t-test (if \(\sigma\) is unknown)</h3>
                \[ t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}} \]
              </div>
            </div>
        </div>
      </section>

      <!-- Step 4 -->
      <section data-menu="mindmap-step4" data-topic="Step 4: Make a Decision">
        <h2>Step 4: Make a Decision</h2>
        <div class="mind-map">...<div class="map-arrow">→</div><div class="map-step active"><div class="step-number">4</div>Make Decision</div><div class="map-arrow">→</div>...</div>
        <p>Two approaches lead to the same conclusion:</p>
        <div style="display:flex; gap:20px; justify-content:center;">
          <div class="callout" style="border-color:var(--accent-green);"><strong>1. Critical Value Approach:</strong> Is our test statistic in the "rejection zone"?</div>
          <div class="callout fragment" style="border-color:var(--accent-orange);"><strong>2. P-Value Approach:</strong> Is our result statistically "weird" if the null is true?</div>
        </div>
      </section>

      <!-- Critical value tool -->
      <section data-menu="critical-value-tool" data-topic="Critical Value Approach">
          <h2>Interactive: Rejection Regions</h2>
          <p class="small">This is the "line in the sand." If our test statistic crosses it, we reject \(H_0\).</p>
          <div class="interactive-tool">
              <div class="tool-controls">
                  <label><input type="radio" name="tail-type" value="two" checked> Two-Tailed</label>
                  <label><input type="radio" name="tail-type" value="left"> Left-Tailed</label>
                  <label><input type="radio" name="tail-type" value="right"> Right-Tailed</label>
                  <label for="alpha-slider-crit">Alpha (\(\alpha\)): <span id="alpha-val-crit">0.05</span></label>
                  <input type="range" id="alpha-slider-crit" min="1" max="20" value="5" step="1">
              </div>
              <canvas class="tool-canvas" id="crit-canvas"></canvas>
              <div class="tool-output" id="crit-output">Critical Value(s): ±1.96</div>
          </div>
      </section>

      <!-- P-value tool -->
      <section data-menu="p-value-tool" data-topic="P-Value Approach">
          <h2>Interactive: P-Value Explorer</h2>
          <p class="small">The P-value is the probability of seeing a result as extreme as yours (or more so), assuming \(H_0\) is true. A small P-value means your result is "weird."</p>
          <div class="interactive-tool">
              <div class="tool-controls">
                <label for="test-stat-slider">Test Statistic (z): <span id="test-stat-val">1.50</span></label>
                <input type="range" id="test-stat-slider" min="-3" max="3" value="1.5" step="0.01">
                <label><input type="radio" name="tail-type-p" value="two" checked> Two-Tailed</label>
                <label><input type="radio" name="tail-type-p" value="left"> Left-Tailed</label>
                <label><input type="radio" name="tail-type-p" value="right"> Right-Tailed</label>
              </div>
              <canvas class="tool-canvas" id="pval-canvas"></canvas>
              <div class="tool-output" id="pval-output">P-Value: 0.134</div>
          </div>
          <h3 class="fragment">Decision Rule: If P-value \(\le \alpha\), Reject \(H_0\).</h3>
      </section>
      
      <section data-menu="which-test" data-topic="z or t?">
        <h2>Which Test Should I Use?</h2>
        <div class="left-align">
          <ul>
            <li><span class="pill">Use <strong>z-test</strong></span> if population SD \(\sigma\) is known.</li>
            <li><span class="pill">Use <strong>t-test</strong></span> if \(\sigma\) is unknown and you estimate with sample SD \(s\) (typical in practice).</li>
          </ul>
          <div class="callout" style="border-left-color:var(--accent-green);">
            <strong>Decision Helper:</strong> If you are using a standard deviation calculated from your sample data (\(s\)), you must use the <strong>t-test</strong>.
          </div>
        </div>
      </section>
      
      <section data-menu="assumptions" data-topic="Assumptions">
        <h2>Assumptions Checklist</h2>
        <div class="left-align">
          <ul>
            <li><strong>Random Sample:</strong> The data should be from a simple random sample to avoid bias.</li>
            <li><strong>Normality/Large Sample:</strong> The population is approximately normal, OR your sample size is large enough (e.g., \(n \ge 30\)) for the Central Limit Theorem to apply.</li>
          </ul>
          <p class="small">Always inspect a histogram or boxplot of your sample data. Mild skew is okay for larger samples, but strong skew or outliers in small samples are a concern.</p>
        </div>
      </section>

      <!-- Example -->
      <section data-menu="z-test-example" data-topic="z-Test Example">
          <h2>Try It: A Full z-Test</h2>
          <div class="left-align">
              <p>A school claims its students' average IQ is 100. You test a sample of 36 students and find \(\bar{x}=104\). Assume you know \(\sigma=15\). Test the school's claim at \(\alpha=0.05\).</p>
          </div>
          <div class="card">
              <div class="card-inner">
                  <div class="card-face front"><h3>Click to Reveal Step-by-Step Solution</h3></div>
                  <div class="card-face back">
                      <ol>
                          <li><strong>Hypotheses:</strong> \(H_0: \mu = 100\), \(H_a: \mu \neq 100\) (two-tailed)</li>
                          <li><strong>Significance:</strong> \(\alpha = 0.05\)</li>
                          <li><strong>Test Statistic:</strong> \[z = \frac{104 - 100}{15/\sqrt{36}} = \frac{4}{2.5} = 1.60\]</li>
                          <li><strong>Decision (P-value):</strong> P-value for z=1.60 (two-tailed) is \(2 \times P(Z > 1.60) = 2 \times 0.0548 = 0.1096\). Since \(0.1096 > 0.05\), we <strong>do not reject \(H_0\)</strong>.</li>
                          <li><strong>Conclusion:</strong> There is not sufficient evidence at the 5% level to reject the school's claim that the average student IQ is 100.</li>
                      </ol>
                  </div>
              </div>
          </div>
      </section>

      <!-- CI ↔ Test connection -->
      <section data-menu="ci-connection" data-topic="CI ↔ Test">
        <h2>Confidence Interval and Hypothesis Test: Same Story</h2>
        <div class="interactive-tool">
          <div class="tool-controls">
            <label>\(\bar{x}\) <input type="number" id="ci_xbar" value="104" step="0.01"></label>
            <label>\(s\) (or \(\sigma\)) <input type="number" id="ci_s" value="15" step="0.01"></label>
            <label>\(n\) <input type="number" id="ci_n" value="36" step="1" min="2"></label>
            <label>\(\mu_0\) <input type="number" id="ci_mu0" value="100" step="0.01"></label>
            <label>\(\alpha\)
              <select id="ci_alpha">
                <option value="0.10">0.10</option>
                <option value="0.05" selected>0.05</option>
                <option value="0.01">0.01</option>
              </select>
            </label>
            <label>
              Test
              <select id="ci_testtype">
                <option value="t" selected>t (σ unknown)</option>
                <option value="z">z (σ known)</option>
              </select>
            </label>
            <button id="ci_calc" class="primary">Compute</button>
          </div>
          <div id="ci_output" class="left-align small">Enter values and click Compute.</div>
        </div>
        <p class="small left-align">Rule of thumb: If \(\mu_0\) lies <em>outside</em> the 95% CI, a two-sided test at \(\alpha=0.05\) will reject \(H_0\). If it lies inside, you will fail to reject.</p>
      </section>

      <!-- Mini one-sample calculator -->
      <section data-menu="mini-calc" data-topic="Calculator">
        <h2>One-Sample Mean Test — Mini Calculator</h2>
        <div class="interactive-tool">
          <div class="tool-controls">
            <label>\(\bar{x}\) <input type="number" id="calc_xbar" value="9.3" step="0.01"></label>
            <label>\(s\) (or \(\sigma\)) <input type="number" id="calc_s" value="1.8" step="0.01"></label>
            <label>\(n\) <input type="number" id="calc_n" value="15" step="1" min="2"></label>
            <label>\(\mu_0\) <input type="number" id="calc_mu0" value="8" step="0.01"></label>
            <label>\(\alpha\)
              <select id="calc_alpha">
                <option value="0.10">0.10</option>
                <option value="0.05" selected>0.05</option>
                <option value="0.01">0.01</option>
              </select>
            </label>
            <label>Alternative
              <select id="calc_tail">
                <option value="two" selected>Two-sided (≠)</option>
                <option value="greater">Right-tailed ( > )</option>
                <option value="less">Left-tailed ( < )</option>
              </select>
            </label>
            <label>
              Test
              <select id="calc_testtype">
                <option value="t" selected>t (σ unknown)</option>
                <option value="z">z (σ known)</option>
              </select>
            </label>
            <button id="calc_go" class="primary">Run Test</button>
          </div>
          <div id="calc_output" class="left-align small">Fill and click Run Test.</div>
        </div>
        <p class="small left-align">This calculator reports the test statistic, P-value, confidence interval, and a plain-English decision.</p>
      </section>

      <!-- Quick misconceptions check -->
      <section data-menu="quiz" data-topic="Misconceptions">
        <h2>Quick Check: Common Misconceptions</h2>
        <div class="left-align" id="quiz_block">
          <div>
            <p><strong>Q1.</strong> A P-value of 0.03 means there’s a 97% chance \(H_a\) is true.</p>
            <div class="quiz-choice" data-q="1" data-correct="no">True</div>
            <div class="quiz-choice" data-q="1" data-correct="yes">False</div>
          </div>
          <div style="margin-top:12px;">
            <p><strong>Q2.</strong> If we fail to reject \(H_0\), then \(H_0\) must be true.</p>
            <div class="quiz-choice" data-q="2" data-correct="no">True</div>
            <div class="quiz-choice" data-q="2" data-correct="yes">False</div>
          </div>
        </div>
        <p class="small left-align" id="quiz_feedback"></p>
      </section>

      <!-- Full process recap -->
      <section data-menu="mindmap-final" data-topic="The Full Process">
        <h2>The Complete Mind-Map</h2>
        <div class="mind-map">
          <div class="map-step active"><div class="step-number">1</div>State \(H_0, H_a\)</div>
          <div class="map-arrow">→</div>
          <div class="map-step active"><div class="step-number">2</div>Set \(\alpha\)</div>
          <div class="map-arrow">→</div>
          <div class="map-step active"><div class="step-number">3</div>Compute \(z\) or \(t\)</div>
          <div class="map-arrow">→</div>
          <div class="map-step active"><div class="step-number">4</div>Compare \(P\) to \(\alpha\) OR test stat to critical value</div>
          <div class="map-arrow">→</div>
          <div class="map-step active"><div class="step-number">5</div>Conclude in context</div>
        </div>
      </section>
    </div>
  </div>

  <script>
    // This script block contains all the JavaScript logic to make the deck interactive.
    // It is included here for completeness but has been omitted from the preview for brevity.
  </script>
  
  <!-- MathJax for LaTeX Rendering -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(', '\\)']], displayMath: [['\\[', '\\]']] }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

  <!-- JStat for statistical calculations -->
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>

  <!-- Reveal & plugins -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/reveal.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/menu.js"></script>

  <script>
    const deck = new Reveal({ hash:true, slideNumber:'c/t', navigationMode:'default', transition:'fade', width:1280, height:720, margin:0.04, plugins:[RevealMenu] });
    deck.initialize();

    // --- Core UI and Event Setup ---

    function setupThemeToggle(){
      const btn = document.getElementById('theme-toggle');
      if (!btn) return;
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
      let theme = localStorage.getItem('slides-theme') || (prefersDark.matches ? 'dark' : 'light');
      document.body.setAttribute('data-theme', theme);
      btn.addEventListener('click', () => {
        theme = (document.body.getAttribute('data-theme') === 'dark') ? 'light' : 'dark';
        document.body.setAttribute('data-theme', theme);
        localStorage.setItem('slides-theme', theme);
      });
    }

    function updateHeaderTopic(){
      const el = document.getElementById('topic-slot');
      if (el) el.textContent = deck.getCurrentSlide()?.dataset?.topic || 'Statistics';
    }

    function setupInteractions(){
      document.body.addEventListener('click', e => {
        const card = e.target.closest('.card');
        if(card) card.classList.toggle('flipped');
      });
    }

    // --- Canvas Drawing Utilities ---
    function drawDistribution(ctx, pdf, color, range, yMax, w, h, shade_regions = []) {
        const toScreenX = (x) => (x - range.min) / (range.max - range.min) * w;
        const toScreenY = (y) => h - (y / yMax) * h;

        ctx.strokeStyle = color;
        ctx.lineWidth = 2;
        ctx.beginPath();
        for (let i = 0; i <= w; i++) {
            const x = range.min + (i/w) * (range.max - range.min);
            const y = pdf(x);
            if (i === 0) ctx.moveTo(i, toScreenY(y)); else ctx.lineTo(i, toScreenY(y));
        }
        ctx.stroke();

        ctx.fillStyle = color;
        ctx.globalAlpha = 0.2;
        shade_regions.forEach(region => {
             ctx.beginPath();
             const startX = toScreenX(region.start);
             const endX = toScreenX(region.end);
             ctx.moveTo(startX, toScreenY(0));
             for (let i = Math.floor(startX); i <= endX; i++) {
                const x = range.min + (i/w) * (range.max - range.min);
                ctx.lineTo(i, toScreenY(pdf(x)));
             }
             ctx.lineTo(endX, toScreenY(0));
             ctx.closePath();
             ctx.fill();
        });
        ctx.globalAlpha = 1.0;
    }

    // --- Interactive Tools ---

    function setupCritTool() {
        const canvas = document.getElementById('crit-canvas'); if (!canvas) return;
        const alphaSlider = document.getElementById('alpha-slider-crit');
        const alphaVal = document.getElementById('alpha-val-crit');
        const output = document.getElementById('crit-output');
        const tailRadios = document.querySelectorAll('input[name="tail-type"]');

        function draw() {
            const alpha = parseInt(alphaSlider.value) / 100;
            const tailType = document.querySelector('input[name="tail-type"]:checked').value;
            alphaVal.textContent = alpha.toFixed(2);

            const w = canvas.clientWidth, h = canvas.clientHeight, ratio = devicePixelRatio;
            canvas.width = w * ratio; canvas.height = h * ratio;
            const ctx = canvas.getContext('2d');
            ctx.scale(ratio, ratio);

            let regions = [], crit_text = "";
            if (tailType === 'two') {
                const z_crit = jStat.normal.inv(1 - alpha / 2, 0, 1);
                regions = [{start: -4, end: -z_crit}, {start: z_crit, end: 4}];
                crit_text = `Critical Values: ±${z_crit.toFixed(3)}`;
            } else if (tailType === 'left') {
                const z_crit = jStat.normal.inv(alpha, 0, 1);
                regions = [{start: -4, end: z_crit}];
                crit_text = `Critical Value: ${z_crit.toFixed(3)}`;
            } else {
                const z_crit = jStat.normal.inv(1 - alpha, 0, 1);
                regions = [{start: z_crit, end: 4}];
                crit_text = `Critical Value: ${z_crit.toFixed(3)}`;
            }
            output.textContent = crit_text;
            
            drawDistribution(ctx, x => jStat.normal.pdf(x, 0, 1), 'var(--brand-primary)', {min: -4, max: 4}, 0.45, w, h, regions);
        }
        alphaSlider.addEventListener('input', draw);
        tailRadios.forEach(r => r.addEventListener('change', draw));
        if(document.body.contains(canvas)) draw();
    }
    
    function setupPValTool() {
        const canvas = document.getElementById('pval-canvas'); if (!canvas) return;
        const statSlider = document.getElementById('test-stat-slider');
        const statVal = document.getElementById('test-stat-val');
        const output = document.getElementById('pval-output');
        const tailRadios = document.querySelectorAll('input[name="tail-type-p"]');

        function draw() {
            const test_stat = parseFloat(statSlider.value);
            const tailType = document.querySelector('input[name="tail-type-p"]:checked').value;
            statVal.textContent = test_stat.toFixed(2);

            const w = canvas.clientWidth, h = canvas.clientHeight, ratio = devicePixelRatio;
            canvas.width = w * ratio; canvas.height = h * ratio;
            const ctx = canvas.getContext('2d');
            ctx.scale(ratio, ratio);

            let regions = [], p_val = 0;
            if (tailType === 'two') {
                const abs_stat = Math.abs(test_stat);
                p_val = 2 * (1 - jStat.normal.cdf(abs_stat, 0, 1));
                regions = [{start: -4, end: -abs_stat}, {start: abs_stat, end: 4}];
            } else if (tailType === 'left') {
                p_val = jStat.normal.cdf(test_stat, 0, 1);
                regions = [{start: -4, end: test_stat}];
            } else {
                p_val = 1 - jStat.normal.cdf(test_stat, 0, 1);
                regions = [{start: test_stat, end: 4}];
            }
            output.textContent = `P-Value: ${p_val.toFixed(4)}`;

            drawDistribution(ctx, x => jStat.normal.pdf(x, 0, 1), 'var(--accent-orange)', {min: -4, max: 4}, 0.45, w, h, regions);

            const stat_x = (test_stat - (-4)) / 8 * w;
            ctx.strokeStyle = 'var(--accent-red)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(stat_x, 0); ctx.lineTo(stat_x, h);
            ctx.stroke();
        }
        statSlider.addEventListener('input', draw);
        tailRadios.forEach(r => r.addEventListener('change', draw));
        if(document.body.contains(canvas)) draw();
    }
    
    function setupCIConnector(){
      const xbar = document.getElementById('ci_xbar'), s = document.getElementById('ci_s'), n = document.getElementById('ci_n'),
            mu0 = document.getElementById('ci_mu0'), alpha = document.getElementById('ci_alpha'), testtype = document.getElementById('ci_testtype'),
            out = document.getElementById('ci_output'), btn = document.getElementById('ci_calc');
      if(!btn) return;
      btn.addEventListener('click', () => {
        const [xb, ss, nn, m0, a] = [xbar, s, n, mu0, alpha].map(el => parseFloat(el.value));
        const se = ss / Math.sqrt(nn);
        let crit, dist;
        if(testtype.value === 'z'){
          crit = jStat.normal.inv(1 - a/2, 0, 1); dist = 'z';
        } else {
          crit = jStat.studentt.inv(1 - a/2, nn-1); dist = `t (df=${nn-1})`;
        }
        const moe = crit * se, lo = xb - moe, hi = xb + moe, outside = (m0 < lo || m0 > hi);
        out.innerHTML = `
          <p><strong>${(1-a)*100}% CI:</strong> [${lo.toFixed(3)}, ${hi.toFixed(3)}] using ${dist}, SE = ${se.toFixed(4)}, critical = ${crit.toFixed(3)}</p>
          <p><strong>Decision link (two-sided):</strong> &mu;<sub>0</sub> ${outside ? '<span style="color:#c2410c;">is outside</span>' : '<span style="color:#15803d;">is inside</span>'} the CI &rArr; ${outside ? '<strong>Reject</strong> H<sub>0</sub>' : '<strong>Fail to reject</strong> H<sub>0</sub>'} at &alpha; = ${a}</p>
        `;
      });
    }

    function setupMiniCalc(){
      const xbar = document.getElementById('calc_xbar'), s = document.getElementById('calc_s'), n = document.getElementById('calc_n'),
            mu0 = document.getElementById('calc_mu0'), alpha = document.getElementById('calc_alpha'), tail = document.getElementById('calc_tail'),
            testtype = document.getElementById('calc_testtype'), out = document.getElementById('calc_output'), btn = document.getElementById('calc_go');
      if(!btn) return;

      const pval = {
          z: (z, tail) => tail === 'two' ? 2*(1-jStat.normal.cdf(Math.abs(z),0,1)) : (tail === 'greater' ? 1-jStat.normal.cdf(z,0,1) : jStat.normal.cdf(z,0,1)),
          t: (t, df, tail) => tail === 'two' ? 2*(1-jStat.studentt.cdf(Math.abs(t),df)) : (tail === 'greater' ? 1-jStat.studentt.cdf(t,df) : jStat.studentt.cdf(t,df))
      };

      btn.addEventListener('click', () => {
        const [xb, ss, nn, m0, a] = [xbar, s, n, mu0, alpha].map(el => parseFloat(el.value));
        const se = ss / Math.sqrt(nn), df = nn-1;
        const stat = (xb - m0) / se;
        let p, crit_95, moe, lo, hi;

        if(testtype.value === 'z'){
            p = pval.z(stat, tail.value);
            crit_95 = jStat.normal.inv(0.975, 0, 1);
        } else {
            p = pval.t(stat, df, tail.value);
            crit_95 = jStat.studentt.inv(0.975, df);
        }
        moe = crit_95 * se; lo = xb - moe; hi = xb + moe;
        const decision = (p <= a) ? '<span style="color:#15803d;"><strong>Reject H<sub>0</sub></strong></span>' : '<span style="color:#9a3412;"><strong>Fail to reject H<sub>0</sub></strong></span>';
        out.innerHTML = `
          <p><strong>Test:</strong> ${testtype.value==='z' ? 'z' : `t (df=${df})`} | <strong>SE</strong> = ${se.toFixed(4)}</p>
          <p><strong>Statistic:</strong> ${testtype.value==='z'?'z':'t'} = ${stat.toFixed(3)} | <strong>P-value:</strong> ${p.toFixed(4)} | <strong>&alpha;:</strong> ${a}</p>
          <p><strong>95% CI (two-sided):</strong> [${lo.toFixed(3)}, ${hi.toFixed(3)}]</p>
          <p><strong>Decision at &alpha;=${a}:</strong> ${decision}</p>
        `;
      });
    }
    
    function setupQuiz(){
      const container = document.getElementById('quiz_block'), feedback = document.getElementById('quiz_feedback');
      if(!container) return;
      container.addEventListener('click', (e)=>{
        const choice = e.target.closest('.quiz-choice');
        if(!choice) return;
        const correct = choice.dataset.correct === 'yes', q = choice.dataset.q;
        container.querySelectorAll(`.quiz-choice[data-q="${q}"]`).forEach(el => el.classList.remove('correct','incorrect'));
        choice.classList.add(correct ? 'correct' : 'incorrect');
        if(q==='1'){
          feedback.textContent = correct ? 'Correct: P-value is NOT the probability that H_a is true; it\'s computed assuming H_0 is true.'
                                         : 'Not quite. P-value is the probability of the observed (or more extreme) result if H_0 were true.';
        } else if(q==='2'){
          feedback.textContent = correct ? 'Correct: Failing to reject does not prove H_0 true; it means the evidence was insufficient.'
                                         : 'Not quite. Failing to reject H_0 does not confirm it is true.';
        }
      });
    }

    deck.on('ready', () => {
        setupThemeToggle();
        updateHeaderTopic();
        setupInteractions();
        setupCritTool();
        setupPValTool();
        setupCIConnector();
        setupMiniCalc();
        setupQuiz();
    });

    deck.on('slidechanged', (event) => {
        updateHeaderTopic();
        if (event.currentSlide.contains(document.getElementById('crit-canvas'))) setupCritTool();
        if (event.currentSlide.contains(document.getElementById('pval-canvas'))) setupPValTool();
    });
  </script>
</body>
</html>


