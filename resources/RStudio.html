<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MATH 1320 — RStudio Dashboard | Prof. Vinay Kanth Rao Kodipelly</title>

    <!-- KaTeX (Math Rendering) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- Prism (Code Highlighting) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.css">
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>

    <!-- Fonts: Inter (UI), Source Serif 4 (Headers), Fira Code (Code) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Source+Serif+4:ital,wght@0,400;0,600;0,700;1,400&family=Fira+Code:wght@450;600&display=swap"
        rel="stylesheet">

    <style>
        :root {
            /* Palette: University Crimson & Slate */
            --bg: #ffffff;
            --bg-sidebar: #f8fafc;
            --ink: #1e293b;
            --muted: #64748b;
            --primary: #A10022;
            /* Crimson */
            --primary-soft: #fff1f2;
            --border: #e2e8f0;
            --accent: #F59E0B;

            /* Dimensions */
            --header-h: 80px;
            --nav-w: 280px;
            --context-w: 320px;
            --serif: "Source Serif 4", Georgia, serif;
            --sans: "Inter", system-ui, sans-serif;
            --mono: "Fira Code", monospace;
        }

        :root.dark {
            --bg: #0f172a;
            --bg-sidebar: #1e293b;
            --ink: #f1f5f9;
            --muted: #94a3b8;
            --border: #334155;
            --primary-soft: #3f151b;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--sans);
            background: var(--bg);
            color: var(--ink);
            height: 100vh;
            overflow: hidden;
            /* Prevent body scroll */
            display: flex;
            /* Flex layout for Header - Grid - Footer */
            flex-direction: column;
        }

        /* --- 1. FIXED HEADER --- */
        .app-header {
            height: var(--header-h);
            background: var(--bg);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            flex-shrink: 0;
            /* Never shrink */
            z-index: 50;
        }

        .brand {
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 100%;
        }

        .brand-title {
            font-size: 20px;
            font-weight: 800;
            color: var(--primary);
            letter-spacing: -0.01em;
            line-height: 1.1;
        }

        .brand-subtitle {
            font-size: 13px;
            color: var(--muted);
            font-weight: 500;
            margin-top: 2px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .menu-btn {
            display: none;
            /* Hidden on desktop */
            background: transparent;
            border: 1px solid var(--border);
            color: var(--ink);
            padding: 6px 10px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
        }

        .header-controls button {
            background: transparent;
            border: 1px solid var(--border);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            color: var(--ink);
            font-size: 13px;
            transition: background 0.2s;
            font-weight: 500;
        }

        .header-controls button:hover {
            background: var(--bg-sidebar);
        }

        /* --- 2. LAYOUT GRID (The Holy Grail) --- */
        .app-grid {
            display: grid;
            grid-template-columns: var(--nav-w) 1fr var(--context-w);
            flex: 1;
            /* Takes all remaining height between header and footer */
            overflow: hidden;
            /* Contains the scrollable children */
            min-height: 0;
            /* Critical for nested flex scrolling */
        }

        /* --- 3. LEFT NAV RAIL --- */
        .nav-rail {
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border);
            overflow-y: auto;
            padding: 20px 0 60px 0;
            display: flex;
            flex-direction: column;
        }

        .nav-group-title {
            padding: 8px 24px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--muted);
            font-weight: 700;
            margin-top: 16px;
        }

        .nav-item {
            display: block;
            padding: 8px 24px;
            font-size: 14px;
            color: var(--ink);
            text-decoration: none;
            border-left: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-item:hover {
            background: rgba(0, 0, 0, 0.03);
            color: var(--primary);
        }

        .nav-item.active {
            background: var(--primary-soft);
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }

        /* --- 4. MAIN CONTENT STAGE --- */
        .main-stage {
            overflow-y: auto;
            /* Independent scroll */
            padding: 40px 60px 40px;
            background: var(--bg);
            display: flex;
            flex-direction: column;
        }

        .content-wrapper {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .content-section {
            display: none;
            /* Hidden by default */
            animation: fadeIn 0.3s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Typography Styles */
        h1,
        h2,
        h3 {
            font-family: var(--serif);
            color: var(--ink);
        }

        h1 {
            font-size: 32px;
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        h2 {
            font-size: 24px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 24px;
        }

        h3 {
            font-size: 18px;
            margin-top: 32px;
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 12px;
        }

        h4 {
            font-size: 16px;
            margin-top: 24px;
            color: var(--ink);
            font-weight: 700;
        }

        p,
        li {
            line-height: 1.65;
            color: var(--ink);
            margin-bottom: 16px;
        }

        strong {
            font-weight: 600;
            color: var(--ink);
        }

        /* --- 5. RIGHT CONTEXT RAIL --- */
        .context-rail {
            background: var(--bg);
            border-left: 1px solid var(--border);
            overflow-y: auto;
            padding: 24px;
        }

        .context-card {
            background: var(--bg-sidebar);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .context-title {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--muted);
            font-weight: 700;
            margin-bottom: 12px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 8px;
        }

        .def-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .def-table th {
            text-align: left;
            padding: 6px 4px;
            color: var(--primary);
            font-family: var(--serif);
            font-size: 15px;
            border-bottom: 1px solid var(--border);
        }

        .def-table td {
            padding: 6px 4px;
            color: var(--muted);
            vertical-align: top;
            border-bottom: 1px solid var(--border);
        }

        .def-table tr:last-child th,
        .def-table tr:last-child td {
            border-bottom: none;
        }

        /* --- UI COMPONENTS --- */

        /* Mobile Overlay (Hidden by default) */
        .nav-overlay {
            display: none;
        }

        /* Pills/Chips */
        .chip {
            display: inline-flex;
            font-size: 11px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 99px;
            text-transform: uppercase;
            border: 1px solid var(--border);
            margin-bottom: 12px;
            letter-spacing: 0.03em;
        }

        .chip.foundation {
            background: #eff6ff;
            color: #1e3a8a;
            border-color: #bfdbfe;
        }

        :root.dark .chip.foundation {
            background: #1e3a5f;
            color: #bfdbfe;
            border-color: #3b5c8f;
        }

        .chip.exam {
            background: #fff1f2;
            color: var(--primary);
            border-color: #fda4af;
        }

        :root.dark .chip.exam {
            background: #4a1c2a;
            color: #fda4af;
            border-color: #7a3043;
        }

        .chip.resource {
            background: #ecfdf5;
            color: #047857;
            border-color: #a7f3d0;
        }

        :root.dark .chip.resource {
            background: #1a4d3a;
            color: #a7f3d0;
            border-color: #2d6b4f;
        }

        /* Tabs (Internal) */
        .tab-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 12px;
            position: sticky;
            top: 0;
            background: var(--bg);
            z-index: 10;
        }

        .tab-btn {
            background: transparent;
            border: 1px solid var(--border);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab-btn:hover {
            background: var(--bg-sidebar);
            color: var(--ink);
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .tab-panel {
            display: none;
            animation: fadeIn 0.2s ease;
        }

        .tab-panel.active {
            display: block;
        }

        /* Code Blocks */
        pre[class*="language-"] {
            border-radius: 8px;
            border: 1px solid var(--border);
            font-size: 13px;
            margin: 16px 0;
            position: relative;
            background: #2d3748 !important;
        }

        :root.dark pre[class*="language-"] {
            background: #1a202c !important;
        }

        /* Code Accessibiity Features */
        .block-container {
            position: relative;
            margin: 16px 0;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-sidebar);
        }

        .block-header {
            display: flex;
            justify-content: flex-end;
            padding: 8px 12px;
            border-bottom: 1px solid var(--border);
            background: var(--bg);
            border-radius: 8px 8px 0 0;
            gap: 8px;
        }

        .view-toggle {
            display: flex;
            background: var(--bg-sidebar);
            border-radius: 6px;
            padding: 2px;
            border: 1px solid var(--border);
        }

        .view-btn {
            padding: 4px 12px;
            font-size: 11px;
            font-weight: 600;
            border: none;
            background: transparent;
            color: var(--muted);
            cursor: pointer;
            border-radius: 4px;
        }

        .view-btn.active {
            background: var(--bg);
            color: var(--primary);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .logic-content {
            padding: 16px;
            font-family: var(--font-body);
            font-size: 14px;
            line-height: 1.6;
            color: var(--ink);
            background: var(--bg);
            border-radius: 0 0 8px 8px;
        }

        .logic-content ol {
            padding-left: 20px;
            margin: 0;
        }

        .logic-content li {
            margin-bottom: 8px;
        }

        .block-container pre {
            margin: 0;
            border: none;
            border-radius: 0 0 8px 8px;
        }

        /* Tooltips */
        .explain-term {
            border-bottom: 1px dotted var(--primary);
            cursor: help;
            position: relative;
        }

        .explain-term:hover::after {
            content: attr(data-desc);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--ink);
            color: white;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 100;
            margin-bottom: 6px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .copy-btn {
            /* customized relative to block-header if needed, keeping global for now */
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--bg);
            border: 1px solid var(--border);
            padding: 4px 10px;
            font-size: 11px;
            font-weight: 600;
            border-radius: 4px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s, background 0.2s;
            color: var(--muted);
            z-index: 5;
        }

        /* Adjusted copy button behavior for block containers */
        .block-container .copy-btn {
            top: 50px;
            /* shift down below header */
        }

        pre:hover .copy-btn,
        .block-container:hover .copy-btn {
            opacity: 1;
        }

        .copy-btn:hover {
            background: var(--bg-sidebar);
            color: var(--primary);
            border-color: var(--primary);
        }

        /* --- FOOTER (FIXED BOTTOM) --- */
        .doc-footer {
            flex-shrink: 0;
            /* Prevents shrinking */
            border-top: 1px solid var(--border);
            background: var(--bg-sidebar);
            padding: 12px 24px;
            font-size: 12px;
            color: var(--muted);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .footer-left strong {
            color: var(--primary);
        }

        .footer-links {
            display: flex;
            gap: 16px;
        }

        .footer-links a {
            color: var(--ink);
            text-decoration: none;
            font-weight: 500;
        }

        .footer-links a:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        /* Mobile Responsive */
        @media (max-width: 1000px) {
            .app-grid {
                grid-template-columns: 1fr;
                height: calc(100vh - var(--header-h));
                /* Maintain fixed height behavior */
                position: relative;
            }

            .menu-btn {
                display: block;
            }

            .nav-rail {
                /* Slide-out Drawer Style */
                position: absolute;
                top: 0;
                left: 0;
                bottom: 0;
                width: 260px;
                background: var(--bg);
                border-right: 1px solid var(--border);
                z-index: 100;
                transform: translateX(-100%);
                transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
                box-shadow: 4px 0 24px rgba(0, 0, 0, 0.1);
                display: flex;
                /* Ensure flex layout is kept */
            }

            .nav-rail.open {
                transform: translateX(0);
            }

            /* Overlay when menu is open */
            .nav-overlay {
                display: block;
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.4);
                z-index: 90;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.3s;
                backdrop-filter: blur(2px);
            }

            .nav-overlay.active {
                opacity: 1;
                pointer-events: auto;
            }

            .context-rail {
                display: none;
            }

            .main-stage {
                padding: 24px 20px 80px;
                /* More bottom padding for mobile */
            }

            .doc-footer {
                display: none !important;
                /* Hide footer on mobile to save space */
            }
        }
    </style>
</head>

<body>

    <!-- FIXED HEADER -->
    <header class="app-header">
        <div class="header-left">
            <button class="menu-btn" onclick="toggleMenu()" aria-label="Toggle Navigation">☰</button>
            <div class="brand">
                <div class="brand-title">MATH 1320: RStudio Dashboard</div>
                <div class="brand-subtitle">Prof. Vinay Kanth Rao Kodipelly</div>
            </div>
        </div>
        <div class="header-controls">
            <button onclick="toggleTheme()" title="Toggle Dark/Light Mode">Contrast ◐</button>
        </div>
    </header>

    <!-- THE HOLY GRAIL GRID -->
    <div class="app-grid">
        <div class="nav-overlay" onclick="closeMenu()"></div>

        <!-- 1. LEFT NAVIGATION RAIL -->
        <nav class="nav-rail">
            <div class="nav-group-title">Course Overview</div>
            <a class="nav-item active" onclick="showSection('intro')">RStudio Intro & Setup</a>
            <a class="nav-item" onclick="showSection('tables')">Reference Tables</a>

            <div class="nav-group-title">Data & Probability</div>
            <a class="nav-item" onclick="showSection('ch1')">Ch 1–3: Descriptive Stats</a>
            <a class="nav-item" onclick="showSection('ch4')">Ch 4: Probability Rules</a>
            <a class="nav-item" onclick="showSection('ch5')">Ch 5: Discrete RVs</a>
            <a class="nav-item" onclick="showSection('ch6')">Ch 6: Normal Distribution</a>
            <a class="nav-item" onclick="showSection('ch7')">Ch 7: Sampling Dist</a>

            <div class="nav-group-title">Statistical Inference</div>
            <a class="nav-item" onclick="showSection('ch8')">Ch 8: Confidence Intervals</a>
            <a class="nav-item" onclick="showSection('ch9')">Ch 9: Hypothesis Tests</a>
            <a class="nav-item" onclick="showSection('ch10')">Ch 10: Two-Sample Tests</a>
            <a class="nav-item" onclick="showSection('ch12')">Ch 12: Proportions</a>
            <a class="nav-item" onclick="showSection('ch13')">Ch 13: Chi-Square</a>
            <a class="nav-item" onclick="showSection('ch14')">Ch 14: Regression</a>
            <a class="nav-item" onclick="showSection('ch16')">Ch 16: ANOVA</a>
        </nav>

        <!-- 2. CENTER CONTENT STAGE -->
        <main class="main-stage">
            <div class="content-wrapper">

                <!-- SECTION: INTRO -->
                <section id="intro" class="content-section active">
                    <span class="chip foundation">Course Setup</span>
                    <h1>RStudio Intro & Setup</h1>
                    <p>Welcome to <strong>Posit Cloud</strong> (formerly <em>RStudio.cloud</em>) — your browser‑based
                        RStudio and Quarto workspace.</p>

                    <h3>Step 1 — Create your free Posit Cloud account</h3>
                    <ol>
                        <li>Open <a href="https://posit.cloud" target="_blank">posit.cloud</a> and click <strong>Sign
                                Up</strong>.</li>
                        <li>Use <strong>Continue with Google</strong> (easy) or create an email+password account.</li>
                    </ol>

                    <h3>Step 2 — Start a new RStudio project</h3>
                    <ol>
                        <li>From <strong>Your Workspace</strong>, click <strong>New Project</strong> → <strong>New
                                RStudio Project</strong> (not Jupyter).</li>
                        <li>Wait for <em>Deploying Project…</em> to finish. Rename the project at the top (e.g.,
                            <em>MATH 1320 — HW Workspace</em>).
                        </li>
                    </ol>

                    <h3>Step 3 — Open a Quarto .qmd file</h3>
                    <ol>
                        <li>Go to <strong>File</strong> → <strong>New File</strong> → <strong>Quarto Document…</strong>.
                        </li>
                        <li>Enter a title (e.g., <em>My First Quarto Document</em>) and choose <strong>PDF</strong>
                            (preferred), HTML, or Word. Click <strong>Create</strong>.</li>
                        <li>If prompted to <strong>Install</strong> packages, click Install.</li>
                    </ol>

                    <h3>Step 4 — Render (build) your document</h3>
                    <ol>
                        <li>Click the blue <strong>Render</strong> button at the top of the editor pane.</li>
                        <li>If prompted for format, choose PDF. If PDF errors, pick HTML for now.</li>
                    </ol>

                    <h3>Basic Quarto structure</h3>
                    <pre><code class="language-markdown">---
title: "My Quarto Document"
format: pdf
---

# Introduction
This is an introduction to my analysis.

## Code Chunk Example
```{r}
# A basic R calculation
x <- 1:5
mean(x)
```

# Conclusion
Summary of findings.
</code></pre>
                </section>

                <!-- SECTION: CH 1-3 -->
                <section id="ch1" class="content-section">
                    <span class="chip foundation">Descriptive</span>
                    <h2>Ch 1–3: Descriptive Statistics</h2>

                    <h3>Core R Commands (Data & Calculator)</h3>
                    <pre><code class="language-r"># Storing data
x <- c(100, 200, 300, 400)    # c() stands for "combine"
x = 1:100                    # shorthand sequence

# Miscellaneous helpers
sort(x)                      # sort data
length(x)                    # number of points (sample size)
sum(x)                       # sum of values
table(x)                     # frequency table
stem(x)                      # stem-and-leaf plot

# Indexing & Combining
x[1]                         # Access 1st element
x[1:3]                       # Access 1st through 3rd
y <- c(10, 20, 30, 40)
cbind(x=1:4, y)              # Combine columns (table view)

# Generating random numbers
runif(5, 0, 3)               # 5 real numbers from Uniform(0, 3)
sample(1:1000, 10)           # 10 random integers (no replacement)

# Using R as a calculator
sqrt(9)                      # square root
abs(-3)                      # absolute value
factorial(4)                 # 4! = 24
choose(10, 3)                # C(10,3) = 120</code></pre>

                    <h3>Numerical Summaries</h3>
                    <p>Key formulas:</p>
                    <p>$$ \bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i, \quad s^2 = \frac{\sum (x_i - \bar{x})^2}{n-1} $$
                    </p>
                    <pre><code class="language-r">x <- c(22, 25, 30, 28, 26, 31, 29, 27)
mean(x)
median(x)                    # Center
sd(x)
var(x)                       # Spread
range(x)                     # Min and Max
IQR(x)                       # Q3 - Q1
summary(x)                   # Five-number summary</code></pre>

                    <h3>Visualizations</h3>
                    <pre><code class="language-r"># Histogram (Quantitative)
hist(x, breaks="Sturges", main="Histogram of x")

# Boxplot (Quantitative)
boxplot(x, horizontal=TRUE, main="Boxplot of x")

# Barplot (Categorical/Discrete)
counts <- c(5, 10, 15)
barplot(counts, names.arg=c("A", "B", "C"), main="Bar Chart")</code></pre>
                </section>

                <!-- SECTION: CH 4 Probability -->
                <section id="ch4" class="content-section">
                    <span class="chip foundation">Probability</span>
                    <h2>Chapter 4: Basic Probability</h2>

                    <h3>1. Factorials</h3>
                    <p>$$ n! = n \times (n-1) \times \dots \times 1 $$</p>
                    <div class="block-container">
                        <div class="block-header">
                            <div class="view-toggle">
                                <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                            </div>
                        </div>
                        <pre><code class="language-r"># Calculate 5! (5 * 4 * 3 * 2 * 1)
factorial(5)
</code></pre>
                        <div class="logic-content" style="display:none">
                            <ol>
                                <li><strong>Definition:</strong> The product of all positive integers less than or equal
                                    to $n$.</li>
                                <li><strong>Usage:</strong> Used to count the number of ways to arrange $n$ distinct
                                    items.</li>
                                <li><strong>R Function:</strong> <code>factorial(n)</code> does the multiplication for
                                    you.</li>
                            </ol>
                        </div>
                    </div>

                    <h3>2. Combinations (Order Doesn't Matter)</h3>
                    <p>$$ C(n,k) = \binom{n}{k} = \frac{n!}{k!(n-k)!} $$</p>
                    <div class="block-container">
                        <div class="block-header">
                            <div class="view-toggle">
                                <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                            </div>
                        </div>
                        <pre><code class="language-r"># Choose 3 students from a class of 10
n <- 10
k <- 3
choose(n, k)
</code></pre>
                        <div class="logic-content" style="display:none">
                            <ol>
                                <li><strong>Concept:</strong> Selecting items where the arrangement does <em>not</em>
                                    change the outcome (e.g., a hand of cards, toppings on a pizza).</li>
                                <li><strong>Formula:</strong> Removes the "duplicate" arrangements by dividing by $k!$.
                                </li>
                                <li><strong>R Function:</strong> <code>choose(n, k)</code> calculates the binomial
                                    coefficient directly.</li>
                            </ol>
                        </div>
                    </div>

                    <h3>3. Permutations (Order Matters)</h3>
                    <p>$$ P(n,k) = \frac{n!}{(n-k)!} $$</p>
                    <div class="block-container">
                        <div class="block-header">
                            <div class="view-toggle">
                                <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                            </div>
                        </div>
                        <pre><code class="language-r"># Arrange 3 students in 3 specific seats from 10
n <- 10
k <- 3
choose(n, k) * factorial(k)
</code></pre>
                        <div class="logic-content" style="display:none">
                            <ol>
                                <li><strong>Concept:</strong> Selecting items where the arrangement <em>does</em> change
                                    the outcome (e.g., a combination lock, 1st/2nd/3rd place).</li>
                                <li><strong>Formula:</strong> Equivalent to $C(n,k) \times k!$ because we put the $k$
                                    chosen items in order.</li>
                                <li><strong>R Code:</strong> R doesn't have a direct <code>nPk</code> function, so we
                                    use <code>choose(n, k) * factorial(k)</code>.</li>
                            </ol>
                        </div>
                    </div>
                </section>

                <!-- SECTION: CH 5 Discrete -->
                <section id="ch5" class="content-section">
                    <span class="chip foundation">Distributions</span>
                    <h2>Chapter 5: Discrete Random Variables</h2>

                    <h3>General Discrete RV</h3>
                    <p>$$ E[X] = \sum x_i p_i, \quad \sigma_X = \sqrt{\sum (x_i - \mu)^2 p_i} $$</p>
                    <pre><code class="language-r">outcomes <- c(0, 1, 2)
probabilities <- c(0.1, 0.3, 0.6)

# Expected Value
EV <- sum(outcomes * probabilities)
EV

# Standard Deviation
mu <- EV
sigma <- sqrt(sum((outcomes - mu)^2 * probabilities))
sigma</code></pre>

                    <h3>Binomial Distribution</h3>
                    <p>$$ P(X=k) = \binom{n}{k} p^k (1-p)^{n-k} $$</p>
                    <pre><code class="language-r">n <- 20; p <- 0.3

# dbinom = Density (Exact Probability)
dbinom(5, size=n, prob=p)   # P(X = 5)

# pbinom = "At Most" (Cumulative Probability <=)
pbinom(5, size=n, prob=p)   # P(X <= 5)

# "At Least" (P(X >= k) = 1 - P(X <= k-1))
# Example: P(X >= 5) = 1 - P(X <= 4)
1 - pbinom(4, size=n, prob=p)

# Range: P(8 <= X <= 12)
pbinom(12, size=n, prob=p) - pbinom(7, size=n, prob=p)
</code></pre>

                    <h3>Poisson Distribution</h3>
                    <p>$$ P(X=k) = \frac{\lambda^k e^{-\lambda}}{k!} $$</p>
                    <p>$$ E[X] = \text{Var}(X) = \lambda $$</p>
                    <pre><code class="language-r">lam <- 4
# Exact Probability P(X=5)
dpois(5, lambda=lam)  

# Cumulative Probability: "At Most 5" P(X<=5)
ppois(5, lambda=lam)  

# "At Least 5": P(X >= 5) = 1 - P(X <= 4)
1 - ppois(4, lambda=lam)  

# Quantile: Find k such that P(X <= k) = 0.95
qpois(0.95, lambda=lam)

# Random Sampling
rpois(10, lambda=lam)
</code></pre>
                </section>

                <!-- SECTION: CH 6 Normal -->
                <section id="ch6" class="content-section">
                    <span class="chip foundation">Distributions</span>
                    <h2>Chapter 6: Normal Distribution</h2>

                    <div class="context-card">
                        <div class="context-title">Cheat Sheet</div>
                        <ul style="font-size:13px; margin:0; padding-left:20px; color:var(--muted);">
                            <li><code>pnorm(q)</code> = Area to Left</li>
                            <li><code>qnorm(p)</code> = Percentile (X-value)</li>
                            <li><code>lower.tail=FALSE</code> = Area to Right</li>
                        </ul>
                    </div>

                    <h3>Calculations</h3>
                    <p>$$ Z = \frac{x - \mu}{\sigma} $$</p>
                    <pre><code class="language-r">mu <- 70; sigma <- 10

# Find Area to the LEFT of 84: P(X < 84)
pnorm(84, mean=mu, sd=sigma)

# Find Area to the RIGHT of 84: P(X > 84)
pnorm(84, mean=mu, sd=sigma, lower.tail=FALSE)

# Find the 90th Percentile (Top 10%)
qnorm(0.90, mean=mu, sd=sigma)
</code></pre>
                </section>

                <!-- SECTION: CH 7 Sampling -->
                <section id="ch7" class="content-section">
                    <span class="chip foundation">Theory</span>
                    <h2>Chapter 7: Sampling Distributions</h2>
                    <p>The Central Limit Theorem (CLT) states that for $n \ge 30$, $\bar{x} \sim N(\mu,
                        \sigma/\sqrt{n})$.</p>
                    <pre><code class="language-r"># CLT Simulation
set.seed(1)
mu <- 70; sigma <- 10; n <- 30
B <- 5000
xbar <- replicate(B, mean(rnorm(n, mu, sigma)))
hist(xbar, breaks=30, main="Sampling dist. of x-bar")

# Check mean and SE:
mean(xbar)
sd(xbar)
</code></pre>

                    <h3>Math-Only Snippet: All Possible Means</h3>
                    <p>See the sampling distribution exactly for a tiny population.</p>
                    <pre><code class="language-r">x <- c(1, 2, 3, 4)
combn(x, 2)         # All pairs
combn(x, 2, mean)   # Mean of each pair
</code></pre>
                </section>

                <!-- SECTION: CH 8 CIs -->
                <section id="ch8" class="content-section">
                    <span class="chip exam">Inference</span>
                    <h2>Chapter 8: Confidence Intervals (One Sample)</h2>

                    <div class="tab-nav">
                        <button class="tab-btn active" onclick="switchTab(this, 'ci-z')">Z-Interval (σ Known)</button>
                        <button class="tab-btn" onclick="switchTab(this, 'ci-t')">t-Interval (σ Unknown)</button>
                    </div>

                    <div id="ci-z" class="tab-panel active">
                        <h3>Z-Interval</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when estimating the population mean ($\mu$) and you
                            <em>know</em> the population standard deviation ($\sigma$).
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Formula:</strong>
                            $$ \bar{x} \pm z^* \left(\frac{\sigma}{\sqrt{n}}\right) $$
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <span
                                    style="font-size:12px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px;">R
                                    Code</span>
                            </div>
                            <pre><code class="language-r">data <- c(54, 57, 53, 59, 58)
sigma <- 5; alpha <- 0.05
n <- length(data); x_bar <- mean(data)

# Math-Only Snippet: Manual Calculation
z_star <- qnorm(1 - alpha/2)
ME <- z_star * (sigma/sqrt(n))

# Report:
z_star
ME
c(x_bar - ME, x_bar + ME)
</code></pre>
                        </div>
                    </div>

                    <div id="ci-t" class="tab-panel">
                        <h3>t-Interval</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when estimating the population mean ($\mu$) but the population
                            SD is <em>unknown</em>. Uses sample SD ($s$).
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Formula:</strong>
                            $$ \bar{x} \pm t^* \left(\frac{s}{\sqrt{n}}\right) $$
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <span
                                    style="font-size:12px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px;">R
                                    Code</span>
                            </div>
                            <pre><code class="language-r"># Built-in Function
t.test(data, conf.level=0.95)$conf.int

# Math-Only Snippet: Manual Calculation
s <- sd(data)
t_star <- qt(1 - alpha/2, df=n-1)
ME <- t_star * (s/sqrt(n))

# Report:
t_star
ME
c(x_bar - ME, x_bar + ME)
</code></pre>
                        </div>
                    </div>
                </section>

                <!-- SECTION: CH 9 Hypothesis Tests -->
                <section id="ch9" class="content-section">
                    <span class="chip exam">Inference</span>
                    <h2>Chapter 9: Hypothesis Tests (One Sample)</h2>

                    <div class="tab-nav">
                        <button class="tab-btn active" onclick="switchTab(this, 'ht-z')">Z-Test (σ Known)</button>
                        <button class="tab-btn" onclick="switchTab(this, 'ht-t')">t-Test (σ Unknown)</button>
                    </div>

                    <div id="ht-z" class="tab-panel active">
                        <h3>One-Sample Z-Test</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when you want to test if a sample mean ($\bar{x}$) represents
                            a population with a known mean ($\mu_0$) and known standard deviation ($\sigma$).
                            <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                                $H_0: \mu = \mu_0$ (No difference)<br>
                                $H_a: \mu \neq \mu_0$ (Significant difference)
                            </div>
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Test Statistic:</strong>
                            $$ z = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}} $$
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <div class="view-toggle">
                                    <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                    <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                                </div>
                            </div>
                            <pre><code class="language-r">data <- c(54, 57, 53, 59, 58)
mu_0 <- 55               # Null Hypothesis Mean
sigma <- 5               # Known Pop SD
alpha <- 0.05

x_bar <- mean(data)
n <- length(data)

# 2. Z-Statistic
z <- (x_bar - mu_0) / (sigma / sqrt(n))

# 3. P-values
# Left-tailed (Ha: mu < mu0)
p_left <- pnorm(z)

# Right-tailed (Ha: mu > mu0)
p_right <- 1 - pnorm(z)

# Two-tailed (Ha: mu != mu0)
p_two <- 2 * (1 - pnorm(abs(z)))

# Output results
z
p_two
</code></pre>
                            <div class="logic-content" style="display:none">
                                <ol>
                                    <li><strong>Setup Hypothesis:</strong> Define your sample data vector, the Null
                                        Hypothesis mean (\(\mu_0\)), and the known population Standard Deviation
                                        (\(\sigma\)).</li>
                                    <li><strong>Calculate Sample Stats:</strong> Use <code>mean()</code> to find the
                                        center of your data and <code>length()</code> to find the sample size (n).</li>
                                    <li><strong>Compute Test Statistic (Z):</strong> Calculate how many standard
                                        deviations away your sample mean is from the null hypothesis using the Z-score
                                        formula: \( Z = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}} \).</li>
                                    <li><strong>Find P-Values:</strong> Use <code>pnorm()</code> to find the probability
                                        associated with your Z-score.
                                        <ul>
                                            <li><strong>Left-tailed:</strong> Probability of getting a value lower than
                                                Z.</li>
                                            <li><strong>Right-tailed:</strong> Probability of getting a value higher
                                                than Z (1 minus left).</li>
                                            <li><strong>Two-tailed:</strong> Probability of being that far away in
                                                <em>either</em> direction (multiply tail area by 2).
                                            </li>
                                        </ul>
                                    </li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <div id="ht-t" class="tab-panel">
                        <h3>One-Sample t-Test</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when testing a sample mean ($\bar{x}$) against a target
                            ($\mu_0$) but you <em>do not know</em> the population SD ($\sigma$). Uses sample SD ($s$).
                            <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                                $H_0: \mu = \mu_0$<br>
                                $df = n - 1$
                            </div>
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Test Statistic:</strong>
                            $$ t = \frac{\bar{x} - \mu_0}{s / \sqrt{n}} $$
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <div class="view-toggle">
                                    <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                    <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                                </div>
                            </div>
                            <pre><code class="language-r"># 1. Data & Hypothesis
data <- c(54, 57, 53, 59, 58)
mu_0 <- 55
alpha <- 0.05

x_bar <- mean(data)
s <- sd(data)
n <- length(data)

# 2. t-Statistic
t <- (x_bar - mu_0) / (s / sqrt(n))
df <- n - 1

# 3. P-values (using pt instead of pnorm)
p_two <- 2 * (1 - pt(abs(t), df = df))

t; df; p_two
</code></pre>
                            <div class="logic-content" style="display:none">
                                <ol>
                                    <li><strong>Setup:</strong> Similar to Z-test, but we do <em>not</em> know the
                                        population standard deviation.</li>
                                    <li><strong>Calculate Sample Stats:</strong> Find the mean (<code>x_bar</code>) and
                                        the sample standard deviation (<code>s</code>) using <code>sd()</code>.</li>
                                    <li><strong>Compute Test Statistic (t):</strong> Use the t-score formula: \( t =
                                        \frac{\bar{x} - \mu_0}{s / \sqrt{n}} \). Note the use of <code>s</code> (sample
                                        SD) instead of \(\sigma\).</li>
                                    <li><strong>Degrees of Freedom:</strong> Calculate \( df = n - 1 \). This determines
                                        the shape of the t-distribution.</li>
                                    <li><strong>Find P-Values:</strong> Use <code>pt()</code> (Probability t) instead of
                                        <code>pnorm()</code>. The logic for tails remains the same.
                                    </li>
                                </ol>
                            </div>
                        </div>

                        <h5>Shortcut using t.test</h5>
                        <pre><code class="language-r"># Built-in one-sample t-test
t.test(data, mu = mu_0, alternative = "two.sided")
</code></pre>
                    </div>
                </section>

                <!-- SECTION: CH 10 Two Sample -->
                <section id="ch10" class="content-section">
                    <span class="chip exam">Inference</span>
                    <h2>Chapter 10: Two-Sample Inference</h2>

                    <div class="tab-nav">
                        <button class="tab-btn active" onclick="switchTab(this, 'two-pooled')">Pooled t</button>
                        <button class="tab-btn" onclick="switchTab(this, 'two-welch')">Welch t</button>
                        <button class="tab-btn" onclick="switchTab(this, 'two-paired')">Paired t</button>
                        <button class="tab-btn" onclick="switchTab(this, 'two-nonparam')">Mann-Whitney /
                            Wilcoxon</button>
                    </div>

                    <div id="two-pooled" class="tab-panel active">
                        <h3>Pooled t-test (Equal Variances)</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when comparing means of two independent groups ($\mu_1,
                            \mu_2$) where you assume they have the <em>same variance</em> ($\sigma_1^2 = \sigma_2^2$).
                            <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                                $H_0: \mu_1 = \mu_2$ (Means are equal)<br>
                                $df = n_1 + n_2 - 2$
                            </div>
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Test Statistic (Pooled Variance):</strong>
                            $$ t = \frac{\bar{x}_1 - \bar{x}_2}{S_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}} $$
                            <div style="font-size: 13px; margin-top:8px; color:var(--muted);">
                                where $ S_p^2 = \frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2} $
                            </div>
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <div class="view-toggle">
                                    <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                    <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                                </div>
                            </div>
                            <pre><code class="language-r"># 1. Enter your two independent samples:
group1 <- c(10, 12, 11, 13, 12)
group2 <- c(9, 11, 10, 12, 11)
alpha <- 0.05            # Significance level

# 2. Basic summaries:
n1 <- length(group1)
n2 <- length(group2)
x_bar1 <- mean(group1)
x_bar2 <- mean(group2)
s1 <- sd(group1)
s2 <- sd(group2)

# 3. Pooled variance (assume equal population variances):
S_p2 <- (((n1 - 1) * s1^2) + ((n2 - 1) * s2^2)) / (n1 + n2 - 2)

# 4. t-statistic and degrees of freedom:
t <- (x_bar1 - x_bar2) / sqrt(S_p2 * (1/n1 + 1/n2))
df <- n1 + n2 - 2

# 5. Two-tailed test (H_a: mu1 != mu2):
p_two <- 2 * (1 - pt(abs(t), df = df))
critical_value_two_upper <- qt(1 - alpha/2, df = df)
critical_value_two_lower <- qt(alpha/2, df = df)

# 6. Left-tailed test (H_a: mu1 < mu2):
p_left <- pt(t, df = df)
critical_value_left <- qt(alpha, df = df)

# 7. Right-tailed test (H_a: mu1 > mu2):
p_right <- 1 - pt(t, df = df)
critical_value_right <- qt(1 - alpha, df = df)

# 8. Two-sided Confidence Interval for (mu1 - mu2):
CI_lower <- (x_bar1 - x_bar2) - critical_value_two_upper * sqrt(S_p2*(1/n1 + 1/n2))
CI_upper <- (x_bar1 - x_bar2) + critical_value_two_upper * sqrt(S_p2*(1/n1 + 1/n2))

# 9. Values you usually report:
t
S_p2
df
p_two
critical_value_two_lower
critical_value_two_upper
p_left
critical_value_left
p_right
critical_value_right
CI_lower
CI_upper
</code></pre>
                            <div class="logic-content" style="display:none">
                                <ol>
                                    <li><strong>Input Data:</strong> Define two vectors, one for each group.</li>
                                    <li><strong>Get Summaries:</strong> Calculate size ($n$), mean (notated $\bar{x}$),
                                        and
                                        standard deviation ($s$) for each group separately.</li>
                                    <li><strong>Calculate Pooled Variance ($S_p^2$):</strong> Combine the variances of
                                        both
                                        groups weighted by their size. We assume the groups have equal "spread".</li>
                                    <li><strong>Compute Test Statistic (t):</strong> Compare the <em>difference between
                                            means</em> ($\bar{x}_1 - \bar{x}_2$) to the expected variation (Standard
                                        Error).
                                    </li>
                                    <li><strong>Find P-Values:</strong> Use <code>pt()</code> with $df = n_1 + n_2 - 2$.
                                    </li>
                                    <li><strong>Confidence Interval:</strong> Build a range around the difference in
                                        means
                                        using the critical t-value ($t^*$).</li>
                                </ol>
                            </div>
                        </div>

                        <h5>Pooled two-sample t-test using t.test</h5>
                        <pre><code class="language-r"># Pooled two-sample t-test (equal variances)
t.test(group1, group2,
       alternative = "two.sided",
       var.equal = TRUE,
       conf.level = 0.95)
</code></pre>
                    </div>

                    <div id="two-welch" class="tab-panel">
                        <h3>Welch t-test (Unequal Variances)</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> The default t-test. Use when comparing means of two independent
                            groups where variances <em>might differ</em> ($\sigma_1^2 \neq \sigma_2^2$).
                            <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                                $H_0: \mu_1 = \mu_2$<br>
                                $df \approx$ Welch-Satterthwaite Formula
                            </div>
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Test Statistic:</strong>
                            $$ t = \frac{(\bar{x}_1 - \bar{x}_2) - \Delta_0}{\sqrt{\frac{s_1^2}{n_1} +
                            \frac{s_2^2}{n_2}}} $$
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <div class="view-toggle">
                                    <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                    <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                                </div>
                            </div>
                            <pre><code class="language-r"># 1. Enter your two independent samples:
group1 <- c(10, 12, 11, 13, 12)
group2 <- c(9, 11, 10, 12, 11)
alpha <- 0.05            # Significance level

# 2. Basic summaries:
n1 <- length(group1)
n2 <- length(group2)
x_bar1 <- mean(group1)
x_bar2 <- mean(group2)
s1 <- sd(group1)
s2 <- sd(group2)

# 3. t-statistic using separate variances:
t <- (x_bar1 - x_bar2) / sqrt(s1^2/n1 + s2^2/n2)

# 4. Approximate degrees of freedom (Welch-Satterthwaite):
df_num <- (s1^2/n1 + s2^2/n2)^2
df_den <- ((s1^2/n1)^2)/(n1 - 1) + ((s2^2/n2)^2)/(n2 - 1)
df <- df_num / df_den

# 5. Two-tailed test (H_a: mu1 != mu2):
p_two <- 2 * (1 - pt(abs(t), df = df))
critical_value_two_upper <- qt(1 - alpha/2, df = df)
critical_value_two_lower <- qt(alpha/2, df = df)

# 6. Left-tailed test (H_a: mu1 < mu2):
p_left <- pt(t, df = df)
critical_value_left <- qt(alpha, df = df)

# 7. Right-tailed test (H_a: mu1 > mu2):
p_right <- 1 - pt(t, df = df)
critical_value_right <- qt(1 - alpha, df = df)

# 8. Two-sided Confidence Interval for (mu1 - mu2):
CI_lower <- (x_bar1 - x_bar2) - critical_value_two_upper * sqrt(s1^2/n1 + s2^2/n2)
CI_upper <- (x_bar1 - x_bar2) + critical_value_two_upper * sqrt(s1^2/n1 + s2^2/n2)

# 9. Values you usually report:
t
df
p_two
critical_value_two_lower
critical_value_two_upper
p_left
critical_value_left
p_right
critical_value_right
CI_lower
CI_upper
</code></pre>
                            <div class="logic-content" style="display:none">
                                <ol>
                                    <li><strong>Input Data:</strong> Define two vectors.</li>
                                    <li><strong>Get Summaries:</strong> Calculate summary stats ($n, \bar{x}, s$) for
                                        both
                                        groups.</li>
                                    <li><strong>Compute Test Statistic (t):</strong> The formula looks similar to
                                        Pooled,
                                        but the denominator is different: $\sqrt{s_1^2/n_1 + s_2^2/n_2}$. We do
                                        <em>not</em>
                                        pool the variances.
                                    </li>
                                    <li><strong>Degrees of Freedom:</strong> This is the hard part. We use the
                                        Welch-Satterthwaite equation to approximate $df$. It involves the variances and
                                        sample sizes.</li>
                                    <li><strong>Find P-Values:</strong> Use the calculated $df$ in the <code>pt()</code>
                                        command.</li>
                                </ol>
                            </div>
                        </div>

                        <h5>Welch two-sample t-test using t.test</h5>
                        <pre><code class="language-r"># Welch two-sample t-test (unpooled, default)
t.test(group1, group2,
       alternative = "two.sided",
       var.equal = FALSE,
       conf.level = 0.95)</code></pre>
                    </div>

                    <div id="two-paired" class="tab-panel">
                        <h3>Paired t-test</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when samples are dependent/matched (e.g., Before vs After,
                            Twins). We analyze the single column of <em>differences</em>.
                            <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                                $H_0: \mu_{diff} = 0$ (No difference on average)<br>
                                $df = n_{pairs} - 1$
                            </div>
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Test Statistic:</strong>
                            $$ t = \frac{\bar{d} - 0}{s_d / \sqrt{n}} $$
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <div class="view-toggle">
                                    <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                    <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                                </div>
                            </div>
                            <pre><code class="language-r"># Paired data (e.g., before and after intervention):
before <- c(200, 195, 210, 205, 198)
after <- c(190, 185, 205, 200, 192)
alpha <- 0.05            # Significance level

# Calculate the differences:
diff <- before - after

# Summary statistics for differences:
mean_diff <- mean(diff)
s_diff <- sd(diff)
n <- length(diff)

# Compute the t-statistic:
t <- mean_diff / (s_diff / sqrt(n))

# Degrees of freedom:
df <- n - 1

# Two-tailed test:
p_two <- 2 * (1 - pt(abs(t), df = df))
critical_value_two_upper <- qt(1 - alpha/2, df = df)
critical_value_two_lower <- qt(alpha/2, df = df)

# Left-tailed test:
p_left <- pt(t, df = df)
critical_value_left <- qt(alpha, df = df)

# Right-tailed test:
p_right <- 1 - pt(t, df = df)
critical_value_right <- qt(1 - alpha, df = df)

# Compute Confidence Interval (Two-tailed):
CI_lower <- mean_diff - critical_value_two_upper * (s_diff/sqrt(n))
CI_upper <- mean_diff + critical_value_two_upper * (s_diff/sqrt(n))

# Output the t-statistic, mean difference, standard deviation of differences,
# degrees of freedom, p-values, and Confidence Interval:
t
mean_diff
s_diff
df
p_two
critical_value_two_lower
critical_value_two_upper
p_left
critical_value_left
p_right
critical_value_right
CI_lower
CI_upper
</code></pre>
                            <div class="logic-content" style="display:none">
                                <ol>
                                    <li><strong>Input Data:</strong> Define your 'before' and 'after' vectors.</li>
                                    <li><strong>Calculate Differences:</strong> Create a new vector <code>diff</code> by
                                        subtracting <code>after</code> from <code>before</code>.</li>
                                    <li><strong>Analyze Differences:</strong> Everything else is just a One-Sample
                                        t-test on
                                        the <code>diff</code> vector!</li>
                                    <li><strong>Test Statistic (t):</strong> Calculate $t = \frac{\bar{d}}{s_d /
                                        \sqrt{n}}$
                                        where $\bar{d}$ is the mean difference.</li>
                                    <li><strong>Find P-Values:</strong> Use <code>pt()</code> with $df = n - 1$ (number
                                        of
                                        pairs - 1).</li>
                                </ol>
                            </div>
                        </div>

                        <h5>Paired t-test using t.test</h5>
                        <pre><code class="language-r"># Paired t-test with built-in function
t.test(before, after,
       paired = TRUE,
       alternative = "two.sided",
       conf.level = 0.95)
</code></pre>
                    </div>

                    <div id="two-nonparam" class="tab-panel">
                        <h3>Non-Parametric Tests</h3>
                        <pre><code class="language-r"># Mann-Whitney U (Independent)
wilcox.test(group1, group2, paired=FALSE)

# Wilcoxon Signed-Rank (Paired)
wilcox.test(before, after, paired=TRUE)
</code></pre>
                    </div>
                </section>

                <!-- SECTION: CH 12 Proportions -->
                <section id="ch12" class="content-section">
                    <span class="chip exam">Inference</span>
                    <h2>Chapter 12: Proportions</h2>

                    <div class="tab-nav">
                        <button class="tab-btn active" onclick="switchTab(this, 'prop-one')">One-Sample</button>
                        <button class="tab-btn" onclick="switchTab(this, 'prop-two')">Two-Sample</button>
                    </div>

                    <div id="prop-one" class="tab-panel active">
                        <h3>One-Sample Proportion</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when testing if a population proportion ($p$) differs from a
                            specific value ($p_0$).
                            <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                                $H_0: p = p_0$<br>
                                Conditions: Large counts ($np \ge 10, n(1-p) \ge 10$)
                            </div>
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Test Statistic:</strong>
                            $$ z = \frac{\hat{p} - p_0}{\sqrt{\frac{p_0(1-p_0)}{n}}} $$
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <div class="view-toggle">
                                    <button class="view-btn active" onclick="toggleView(this, 'code')">R Code</button>
                                    <button class="view-btn" onclick="toggleView(this, 'logic')">Logic</button>
                                </div>
                            </div>
                            <pre><code class="language-r"># One-sample z-test for Proportion
x <- 48; n <- 120; p0 <- 0.4
phat <- x/n
alpha <- 0.05

# Test statistic
z <- (phat - p0) / sqrt(p0*(1-p0)/n)

# P-values
p_left <- pnorm(z)
p_right <- 1 - pnorm(z)
p_two <- 2 * (1 - pnorm(abs(z)))

# Output
phat
z
p_two
p_left
p_right
</code></pre>
                            <div class="logic-content" style="display:none">
                                <ol>
                                    <li><strong>Setup:</strong> Define successes ($x$), trials ($n$), and null
                                        proportion
                                        ($p_0$).</li>
                                    <li><strong>Sample Proportion ($\hat{p}$):</strong> Calculate the observed rate:
                                        $\hat{p} = x/n$.</li>
                                    <li><strong>Compute Test Statistic (z):</strong> How many standard deviations is
                                        $\hat{p}$ from $p_0$? Note that the Standard Error uses the <em>Null</em>
                                        proportion
                                        $p_0$.</li>
                                    <li><strong>Find P-Values:</strong> Use `pnorm` since proportions follow a Normal
                                        distribution (Z) under large sample conditions.</li>
                                </ol>
                            </div>
                        </div>

                        <h4>Confidence Interval for Proportion</h4>
                        <p><strong>Confidence Interval (Wald):</strong> $$\hat{p} \pm z^*
                            \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}$$
                        </p>
                        <pre><code class="language-r">x <- 48; n <- 120; phat <- x/n; alpha <- .05
z_star <- qnorm(1 - alpha/2)
ME <- z_star * sqrt(phat*(1-phat)/n)
CI_lower <- phat - ME
CI_upper <- phat + ME

# Output CI
CI_lower
CI_upper
</code></pre>

                        <p class="tiny muted" style="margin-top:6px;">Note: The Wald CI above can be unstable for small
                            n or
                            when \( \hat p \) is near 0 or 1. Prefer <code>prop.test</code> (Wilson score) or the
                            plus-four
                            (Agresti–Coull) interval in those cases.</p>

                        <h4>Proportion test using prop.test</h4>
                        <pre><code class="language-r"># One-sample proportion test
prop.test(x = 48, n = 120,
          p = 0.40,
          alternative = "two.sided",
          conf.level = 0.95,
          correct = FALSE)
</code></pre>
                        <h4>Math-Only Snippet: Agresti-Coull CI (Plus-Four)</h4>
                        <pre><code class="language-r">x <- 46; n <- 50
x_tilde <- x + 2; n_tilde <- n + 4
p_tilde <- x_tilde / n_tilde

# Calculate standard Wald CI using p_tilde
z_star <- qnorm(1 - 0.05/2)
MOE <- z_star * sqrt(p_tilde * (1 - p_tilde) / n_tilde)
c(p_tilde - MOE, p_tilde + MOE)
</code></pre>
                    </div>

                    <div id="prop-two" class="tab-panel">
                        <h3>Two-Sample Proportion</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when comparing proportions from two independent groups ($p_1,
                            p_2$).
                            <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                                $H_0: p_1 = p_2$ (No difference)<br>
                                Uses <strong>Pooled Proportion</strong> ($\hat{p}_{pool}$) for SE.
                            </div>
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Test Statistic:</strong>
                            $$ z = \frac{\hat{p}_1 - \hat{p}_2}{\sqrt{\hat{p}_{pool}(1-\hat{p}_{pool})(\frac{1}{n_1} +
                            \frac{1}{n_2})}} $$
                            <div style="font-size: 13px; margin-top:8px; color:var(--muted);">
                                where $\hat{p}_{pool} = \frac{x_1 + x_2}{n_1 + n_2}$
                            </div>
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <span
                                    style="font-size:12px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px;">R
                                    Code</span>
                            </div>
                            <pre><code class="language-r"># Two-sample z-test for Proportion
x1 <- 56; n1 <- 150
x2 <- 72; n2 <- 160
alpha <- 0.05

# Sample proportions
phat1 <- x1/n1
phat2 <- x2/n2

# Pooled proportion (for test statistic)
phat_pool <- (x1 + x2) / (n1 + n2)

# Test statistic
z <- (phat1 - phat2) / sqrt(phat_pool*(1-phat_pool)*(1/n1 + 1/n2))

# P-values
p_left <- pnorm(z)
p_right <- 1 - pnorm(z)
p_two <- 2 * (1 - pnorm(abs(z)))

# Confidence Interval (Unpooled standard error)
z_star <- qnorm(1 - alpha/2)
SE_unpooled <- sqrt(phat1*(1-phat1)/n1 + phat2*(1-phat2)/n2)
ME <- z_star * SE_unpooled
CI_lower <- (phat1 - phat2) - ME
CI_upper <- (phat1 - phat2) + ME

# Output
phat1; phat2
z
p_two
p_left
p_right
CI_lower
CI_upper
</code></pre>

                            <h4>Proportion test using prop.test</h4>
                            <pre><code class="language-r"># Two-sample proportion test
x <- c(56, 72)
n <- c(150, 160)
prop.test(x = x, n = n,
          alternative = "two.sided",
          conf.level = 0.95,
          correct = FALSE)
</code></pre>
                        </div>
                </section>

                <!-- SECTION: CH 13 Chi-Square -->
                <section id="ch13" class="content-section">
                    <span class="chip exam">Categorical</span>
                    <h2>Chapter 13: Chi-Square Procedures</h2>

                    <h3>Goodness of Fit</h3>

                    <!-- 1. CONCEPT -->
                    <div style="margin-bottom: 16px;">
                        <strong>Concept:</strong> Use when checking if a single categorical variable follows a specific
                        distribution (e.g., "Are the dice fair?", "Do M&M colors match the factory %?").
                        <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                            $H_0:$ Sample matches expected dist.<br>
                            $df = k - 1$ (k = categories)
                        </div>
                    </div>

                    <!-- 2. FORMULA -->
                    <div style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                        <strong>Test Statistic:</strong>
                        $$ \chi^2 = \sum \frac{(O - E)^2}{E} $$
                    </div>

                    <!-- 3. R CODE -->
                    <div class="block-container">
                        <div class="block-header">
                            <span
                                style="font-size:12px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px;">R
                                Code</span>
                        </div>
                        <pre><code class="language-r">counts <- c(12, 3, 6, 20, 9)
probs  <- c(0.2, 0.1, 0.1, 0.3, 0.3) 
chisq.test(counts, p=probs)
</code></pre>

                        <h3>Test of Independence</h3>

                        <!-- 1. CONCEPT -->
                        <div style="margin-bottom: 16px;">
                            <strong>Concept:</strong> Use when checking if <em>two</em> categorical variables are
                            related/dependent (e.g., "Is Voting Preference related to Age Group?").
                            <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                                $H_0:$ Variables are Independent<br>
                                $df = (rows-1)(cols-1)$
                            </div>
                        </div>

                        <!-- 2. FORMULA -->
                        <div
                            style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                            <strong>Test Statistic:</strong>
                            $$ \chi^2 = \sum \frac{(O - E)^2}{E} $$
                            <div style="font-size: 13px; margin-top:8px; color:var(--muted);">
                                where $E_{ij} = \frac{(\text{Row Total})(\text{Col Total})}{\text{Grand Total}}$
                            </div>
                        </div>

                        <!-- 3. R CODE -->
                        <div class="block-container">
                            <div class="block-header">
                                <span
                                    style="font-size:12px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px;">R
                                    Code</span>
                            </div>
                            <pre><code class="language-r"># Create a Matrix
M <- matrix(c(12, 8, 5, 15), nrow=2, byrow=TRUE)
chisq.test(M, correct=FALSE)

# Expected Counts
chisq.test(M)$expected
</code></pre>

                            <h3>Math-Only Snippet: Chi-Square from Scratch</h3>
                            <pre><code class="language-r"># M is an r x c matrix of counts
E  <- outer(rowSums(M), colSums(M)) / sum(M)
X2 <- sum( (M - E)^2 / E )
df <- (nrow(M)-1)*(ncol(M)-1)
p  <- 1 - pchisq(X2, df)
X2; df; p</code></pre>
                </section>

                <!-- SECTION: CH 14 Regression -->
                <section id="ch14" class="content-section">
                    <span class="chip exam">Modeling</span>
                    <h2>Chapter 14: Linear Regression</h2>

                    <!-- 1. CONCEPT -->
                    <div style="margin-bottom: 16px;">
                        <strong>Concept:</strong> Use when Modeling the linear relationship between a quantitative
                        response ($y$) and a predictor ($x$).
                        <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                            $H_0: \beta_1 = 0$ (No relationship)<br>
                            $y = \hat{y} + \epsilon$
                        </div>
                    </div>

                    <!-- 2. FORMULA -->
                    <div style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                        <strong>The Model:</strong>
                        $$ y = \beta_0 + \beta_1 x + \epsilon $$
                    </div>

                    <!-- 3. R CODE -->
                    <div class="block-container">
                        <div class="block-header">
                            <span
                                style="font-size:12px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px;">R
                                Code</span>
                        </div>
                        <pre><code class="language-r">x_data <- c(10, 15, 20, 25, 30)
y_data <- c(12, 18, 22, 28, 35)
model <- lm(y_data ~ x_data)

summary(model) # Shows R-squared, F-stat, Coefficients
coef(model)    # Just b0 and b1
confint(model, level=0.95) # CIs for coefficients
</code></pre>
                    </div>

                    <h3>Math-Only Snippet: Manual Formulas</h3>
                    <pre><code class="language-r">xbar <- mean(x_data); ybar <- mean(y_data)
Sxx <- sum((x_data - xbar)^2)
Sxy <- sum((x_data - xbar)*(y_data - ybar))
b1 <- Sxy / Sxx
b0 <- ybar - b1*xbar

# Residual SE and SE(b1)
e2 <- sum((y_data - (b0 + b1*x_data))^2)
sig2 <- e2 / (length(x_data)-2)
se_b1 <- sqrt(sig2 / Sxx)

# t and CI for Slope
t_val <- b1 / se_b1
t_star <- qt(0.975, df=length(x_data)-2)
c(b1 - t_star*se_b1, b1 + t_star*se_b1)
</code></pre>
                </section>

                <!-- SECTION: CH 16 ANOVA -->
                <section id="ch16" class="content-section">
                    <span class="chip exam">Modeling</span>
                    <h2>Chapter 16: Analysis of Variance (ANOVA)</h2>

                    <!-- 1. CONCEPT -->
                    <div style="margin-bottom: 16px;">
                        <strong>Concept:</strong> Use when comparing the means of <strong>3 or more</strong> independent
                        groups.
                        <div style="margin-top:4px; color:var(--muted); font-size:13px;">
                            $H_0: \mu_1 = \mu_2 = \dots = \mu_k$ (All equal)<br>
                            $H_a$: At least one is different.
                        </div>
                    </div>

                    <!-- 2. FORMULA -->
                    <div style="margin-bottom: 16px; padding: 12px; background: var(--bg-sidebar); border-radius: 8px;">
                        <strong>Test Statistic (F):</strong>
                        $$ F = \frac{MS_{Between}}{MS_{Within}} $$
                        <div style="font-size: 13px; margin-top:8px; color:var(--muted);">
                            Ratio of variance <em>between</em> groups to variance <em>within</em> groups.
                        </div>
                    </div>

                    <!-- 3. R CODE -->
                    <div class="block-container">
                        <div class="block-header">
                            <span
                                style="font-size:12px; font-weight:600; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px;">R
                                Code</span>
                        </div>
                        <pre><code class="language-r"># Easy Way
# fit <- aov(Values ~ Group, data=df)
# summary(fit)
</code></pre>
                    </div>

                    <h3>Math-Only Snippet: Manual ANOVA Table Calculation</h3>
                    <pre><code class="language-r">n <- c(12, 10, 8); xbar <- c(18.2, 20.1, 22.0); s <- c(3.5, 4.1, 3.8)
N <- sum(n)
gbar <- sum(n * xbar) / N

SSB <- sum(n * (xbar - gbar)^2)
SSW <- sum((n - 1) * s^2)

df1 <- length(n) - 1; df2 <- N - length(n)
MSB <- SSB / df1; MSW <- SSW / df2

F_stat <- MSB / MSW
1 - pf(F_stat, df1, df2) # P-value
</code></pre>
                </section>

                <!-- SECTION: TABLES -->
                <section id="tables" class="content-section">
                    <span class="chip resource">Resource</span>
                    <h2>Reference Tables</h2>

                    <div class="tab-nav">
                        <button class="tab-btn active" onclick="switchTab(this, 'tbl-z')">Z-Table</button>
                        <button class="tab-btn" onclick="switchTab(this, 'tbl-t')">t-Table</button>
                        <button class="tab-btn" onclick="switchTab(this, 'tbl-chi')">Chi-Square</button>
                        <button class="tab-btn" onclick="switchTab(this, 'tbl-f')">F-Table</button>
                    </div>

                    <div id="tbl-z" class="tab-panel active">
                        <h3>Standard Normal (Z)</h3>
                        <table class="def-table">
                            <tr>
                                <th>95% CI</th>
                                <td>1.96</td>
                                <td><code>qnorm(0.975)</code></td>
                            </tr>
                            <tr>
                                <th>99% CI</th>
                                <td>2.576</td>
                                <td><code>qnorm(0.995)</code></td>
                            </tr>
                            <tr>
                                <th>Right Tail 0.05</th>
                                <td>1.645</td>
                                <td><code>qnorm(0.95)</code></td>
                            </tr>
                        </table>
                    </div>

                    <div id="tbl-t" class="tab-panel">
                        <h3>Student's t</h3>
                        <table class="def-table">
                            <tr>
                                <th>df=10, 95% CI</th>
                                <td>2.228</td>
                            </tr>
                            <tr>
                                <th>df=20, 95% CI</th>
                                <td>2.086</td>
                            </tr>
                            <tr>
                                <th>df=30, 95% CI</th>
                                <td>2.042</td>
                            </tr>
                        </table>
                    </div>

                    <div id="tbl-chi" class="tab-panel">
                        <h3>Chi-Square (Right Tail 0.05)</h3>
                        <table class="def-table">
                            <tr>
                                <th>df=1</th>
                                <td>3.84</td>
                            </tr>
                            <tr>
                                <th>df=2</th>
                                <td>5.99</td>
                            </tr>
                            <tr>
                                <th>df=3</th>
                                <td>7.81</td>
                            </tr>
                        </table>
                    </div>

                    <div id="tbl-f" class="tab-panel">
                        <h3>F-Distribution (Right Tail 0.05)</h3>
                        <table class="def-table">
                            <tr>
                                <th>df(2, 10)</th>
                                <td>4.10</td>
                            </tr>
                            <tr>
                                <th>df(2, 20)</th>
                                <td>3.49</td>
                            </tr>
                        </table>
                    </div>
                </section>

            </div>
        </main>

        <!-- 3. RIGHT CONTEXT RAIL (Dynamic) -->
        <aside class="context-rail">
            <div class="context-card">
                <div class="context-title">Current Variables</div>
                <table class="def-table">
                    <tbody id="dynamic-vars">
                        <!-- JS injects rows here -->
                    </tbody>
                </table>
            </div>
            <div id="default-msg" style="font-size:12px; color:var(--muted); font-style:italic;">
                Navigate to a chapter to see relevant variable definitions.
            </div>
        </aside>

    </div>

    <!-- FOOTER (FIXED FULL WIDTH) -->
    <footer class="doc-footer">
        <div class="footer-left">
            &copy; 2026 <strong>Prof. Vinay Kanth Rao Kodipelly</strong>. MIT License.
        </div>
        <div class="footer-links">
            <a href="#">Course Syllabus</a>
            <a href="#">Canvas</a>
            <a href="#">RStudio Cloud</a>
        </div>
    </footer>

    <script>
        // --- 1. VARIABLE DEFINITIONS DATA ---
        const VAR_SETS = {
            'intro': [
                { s: 'RStudio', d: 'IDE for R Language' },
                { s: '.qmd', d: 'Quarto Markdown File' },
                { s: 'Render', d: 'Compile to PDF/HTML' }
            ],
            'ch1': [
                { s: '$\\bar{x}$', d: 'Sample Mean' },
                { s: '$s$', d: 'Sample SD' },
                { s: '$s^2$', d: 'Sample Variance' },
                { s: '$Q_1, Q_3$', d: 'Quartiles' },
                { s: 'IQR', d: '$Q_3 - Q_1$' },
                { s: '$n$', d: 'Sample Size' }
            ],
            'ch4': [
                { s: '$n!$', d: 'Factorial' },
                { s: '$C(n,k)$', d: 'Combinations' },
                { s: '$P(n,k)$', d: 'Permutations' }
            ],
            'ch5': [
                { s: '$E[X]$', d: 'Expected Value' },
                { s: '$\\lambda$', d: 'Poisson Rate' },
                { s: '$p$', d: 'Probability of Success' }
            ],
            'ch6': [
                { s: '$\\mu$', d: 'Pop Mean' },
                { s: '$\\sigma$', d: 'Pop SD' },
                { s: '$Z$', d: '$(x-\\mu)/\\sigma$' },
                { s: 'pnorm', d: 'Area to Left' }
            ],
            'ch7': [
                { s: '$\\mu_{\\bar{x}}$', d: 'Mean of $\\bar{x}$' },
                { s: 'SE', d: '$\\sigma / \\sqrt{n}$' },
                { s: 'CLT', d: 'Central Limit Thm' }
            ],
            'ch8': [
                { s: '$\\bar{x}$', d: 'Point Est' },
                { s: 'ME', d: 'Margin of Error' },
                { s: '$z^*$', d: 'Crit Z' },
                { s: '$t^*$', d: 'Crit t' },
                { s: '$df$', d: '$n - 1$' }
            ],
            'ch9': [
                { s: '$H_0$', d: 'Null Hyp' },
                { s: '$H_a$', d: 'Alt Hyp' },
                { s: '$\\alpha$', d: 'Sig Level (0.05)' },
                { s: '$p$-value', d: 'Prob Data | $H_0$' },
                { s: '$z$', d: 'Test Statistic ($\\sigma$ known)' },
                { s: '$t$', d: 'Test Statistic ($\\sigma$ unknown)' }
            ],
            'ch10': [
                { s: '$\\bar{x}_1 - \\bar{x}_2$', d: 'Diff in Means' },
                { s: '$s_p^2$', d: 'Pooled Variance' },
                { s: '$\\bar{d}$', d: 'Mean Diff (Paired)' }
            ],
            'ch12': [
                { s: '$\\hat{p}$', d: 'Sample Prop' },
                { s: '$p_0$', d: 'Null Prop' },
                { s: '$z$', d: 'Test Stat' }
            ],
            'ch13': [
                { s: '$\\chi^2$', d: 'Chi-Square' },
                { s: '$O$', d: 'Observed' },
                { s: '$E$', d: 'Expected' },
                { s: '$df$', d: '$(r-1)(c-1)$' }
            ],
            'ch16': [
                { s: '$F$', d: 'F-Stat' },
                { s: '$SSB$', d: 'Sum Sq Between' },
                { s: '$SSW$', d: 'Sum Sq Within' },
                { s: '$MS$', d: 'Mean Square' }
            ],
            'ch14': [
                { s: '$y$', d: 'Response Var' },
                { s: '$x$', d: 'Predictor Var' },
                { s: '$\\beta_0, \\beta_1$', d: 'Population Params' },
                { s: '$\\hat{y}$', d: 'Predicted Y' },
                { s: '$b_0$', d: 'Intercept Estimate' },
                { s: '$b_1$', d: 'Slope Estimate' },
                { s: '$R^2$', d: 'Coeff Det' }
            ],
            'tables': [
                { s: '$Z$', d: 'Normal Crit Values' },
                { s: '$t$', d: 'Student t' },
                { s: '$\\chi^2$', d: 'Chi-Square' },
                { s: '$F$', d: 'ANOVA Crit' }
            ]
        };

        // --- 2. NAVIGATION LOGIC ---
        function showSection(id) {
            // 1. Hide all sections
            document.querySelectorAll('.content-section').forEach(el => el.classList.remove('active'));
            // 2. Show target
            const target = document.getElementById(id);
            if (target) target.classList.add('active');

            // 3. Update Nav Styling
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            // Find link that calls this function (rough match)
            const links = document.querySelectorAll('.nav-item');
            for (let link of links) {
                if (link.getAttribute('onclick').includes(id)) {
                    link.classList.add('active');
                }
            }

            // 4. Update Right Sidebar
            updateSidebar(id);

            // 5. Scroll content to top
            document.querySelector('.main-stage').scrollTop = 0;

            // 6. Close mobile menu if open
            closeMenu();
        }

        function toggleMenu() {
            document.querySelector('.nav-rail').classList.toggle('open');
            document.querySelector('.nav-overlay').classList.toggle('active');
        }

        function closeMenu() {
            document.querySelector('.nav-rail').classList.remove('open');
            document.querySelector('.nav-overlay').classList.remove('active');
        }

        function updateSidebar(id) {
            const tbody = document.getElementById('dynamic-vars');
            const data = VAR_SETS[id];

            tbody.innerHTML = ''; // Clear existing

            if (data) {
                document.getElementById('default-msg').style.display = 'none';
                data.forEach(item => {
                    const row = `<tr><th>${item.s}</th><td>${item.d}</td></tr>`;
                    tbody.innerHTML += row;
                });

                // Re-render math in the sidebar
                if (window.renderMathInElement) {
                    renderMathInElement(tbody, {
                        delimiters: [
                            { left: "$$", right: "$$", display: true },
                            { left: "$", right: "$", display: false },
                            { left: "\\(", right: "\\)", display: false }
                        ]
                    });
                }
            } else {
                document.getElementById('default-msg').style.display = 'block';
            }
        }

        // --- 3. TAB LOGIC ---
        function switchTab(btn, panelId) {
            const parent = btn.parentElement.parentElement; // Section container
            // Remove active from buttons in this specific section
            parent.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Toggle Panels
            parent.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
            document.getElementById(panelId).classList.add('active');
        }

        // --- 4. THEME LOGIC ---
        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            localStorage.setItem('pref_theme', isDark ? 'dark' : 'light');
        }

        // Init
        (function () {
            // Theme Check
            if (localStorage.getItem('pref_theme') === 'dark') {
                document.documentElement.classList.add('dark');
            }

            // Add Copy Buttons
            document.querySelectorAll('pre').forEach(pre => {
                const btn = document.createElement('button');
                btn.className = 'copy-btn';
                btn.textContent = 'Copy';
                btn.onclick = () => {
                    navigator.clipboard.writeText(pre.innerText);
                    btn.textContent = 'Copied!';
                    setTimeout(() => btn.textContent = 'Copy', 1500);
                };
                pre.appendChild(btn);
            });

            // Initial Sidebar Load
            updateSidebar('intro');
        })();

        // --- 5. KATEX RENDER ---
        document.addEventListener("DOMContentLoaded", function () {
            renderMathInElement(document.body, {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "$", right: "$", display: false },
                    { left: "\\(", right: "\\)", display: false }
                ]
            });
        });
        // --- 6. STUDENT EXPERIENCE FEATURES ---
        const HELP_TERMS = {
            'mean': 'Calculates the average',
            'sd': 'Standard Deviation (spread)',
            'var': 'Variance (spread squared)',
            'length': 'Count of data points',
            'c': 'Combines values into a list',
            'sqrt': 'Square Root',
            'pnorm': 'Finds Probability from Z-score (Area to left)',
            'qnorm': 'Finds Z-score from Probability (Cutoff)',
            'pt': 'Finds Probability from t-score',
            'qt': 'Finds t-score from Probability',
            't.test': 'Runs a t-test automatically',
            'prop.test': 'Runs a proportion test',
            'chisq.test': 'Runs a Chi-Square test',
            'lm': 'Fits a Linear Model',
            'summary': 'Shows detailed results',
            'abline': 'Adds a line to a plot',
            'plot': 'Creates a scatterplot',
            'hist': 'Creates a histogram',
            'boxplot': 'Creates a boxplot',
            'factorial': 'Multiplies n * (n-1) * ... * 1',
            'choose': 'Calculates Combinations',
            'dbinom': 'Binomial Probability (Exact)',
            'pbinom': 'Binomial Probability (Cumulative)',
            'dpois': 'Poisson Probability (Exact)',
            'ppois': 'Poisson Probability (Cumulative)'
        };

        function toggleView(btn, mode) {
            const container = btn.closest('.block-container');
            // Toggle buttons
            container.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Toggle content
            if (mode === 'code') {
                container.querySelector('pre').style.display = 'block';
                container.querySelector('.logic-content').style.display = 'none';
            } else {
                container.querySelector('pre').style.display = 'none';
                container.querySelector('.logic-content').style.display = 'block';
            }
        }

        function initTooltips() {
            // Run after Prism highlights
            document.querySelectorAll('pre code').forEach(block => {
                let html = block.innerHTML;
                // distinct terms to avoid overlapping replacement issues (simple approach)
                Object.keys(HELP_TERMS).forEach(term => {
                    // Regex looks for "function(" or " function " boundaries to avoid partial matches in variables
                    // But Prism wraps things in spans. We need to be careful.
                    // Simple strategy: Look for Prism function class spans
                    // <span class="token function">mean</span>

                    const regex = new RegExp(`(<span class="token function">${term}</span>)`, 'g');
                    if (regex.test(html)) {
                        html = html.replace(regex, `<span class="explain-term" data-desc="${HELP_TERMS[term]}">$1</span>`);
                    }

                    // Also catch keywords that might not be functions in Prism definition but are in our list
                    // e.g. "c" might be special.
                    // For now, relying on Prism's tokenization is safest.
                });
                block.innerHTML = html;
            });
        }

        // Run tooltips after a short delay to ensure Prism finishes
        window.addEventListener('load', () => setTimeout(initTooltips, 500)); 
    </script>
</body>

</html>
