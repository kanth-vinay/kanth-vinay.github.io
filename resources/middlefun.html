<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrated Math: Angle Relationships Assessment</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --accent-color: #3498db;
            --background-color: #f9f9f9;
            --correct-color: #2ecc71;
            --incorrect-color: #e74c3c;
            --text-color: #333;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .quiz-container {
            max-width: 900px;
            margin: 0 auto;
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: var(--primary-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 15px;
        }
        #start-screen {
            text-align: center;
            padding: 50px 20px;
        }
        #quiz-screen {
            display: none;
        }
        .timer-header {
            position: sticky;
            top: 0;
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2em;
            font-weight: bold;
            border-radius: 5px;
            z-index: 100;
            margin-bottom: 25px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .question-block {
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 1px solid #eee;
        }
        .question-text {
            font-size: 1.15em;
            font-weight: 600;
            margin-bottom: 15px;
        }
        .diagram-container {
            text-align: center;
            margin: 20px 0;
            background: #fdfdfd;
            border: 1px solid #eaeaea;
            border-radius: 5px;
            padding: 10px;
        }
        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .option-btn {
            background-color: #fff;
            border: 2px solid var(--accent-color);
            color: var(--text-color);
            padding: 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.2s ease;
            text-align: left;
            font-weight: 500;
        }
        .option-btn:hover:not(:disabled) {
            background-color: #ebf5fb;
        }
        .option-btn.selected {
            background-color: var(--accent-color);
            color: #fff;
        }
        .option-btn.correct {
            background-color: var(--correct-color) !important;
            border-color: var(--correct-color) !important;
            color: #fff !important;
        }
        .option-btn.incorrect {
            background-color: var(--incorrect-color) !important;
            border-color: var(--incorrect-color) !important;
            color: #fff !important;
        }
        .btn-main {
            background-color: var(--accent-color);
            color: #fff;
            border: none;
            padding: 15px 35px;
            font-size: 1.2em;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
            margin: 10px;
        }
        .btn-main:hover:not(:disabled) {
            background-color: #2980b9;
        }
        .btn-main:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        #results {
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 8px;
            display: none;
        }
        .results-subtext {
            font-size: 0.6em; 
            color: var(--text-color); 
            font-weight: normal;
        }
        svg {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <h1>Integrated Math: Angle Relationships</h1>

    <div id="start-screen">
        <h2>Unit 8 Assessment</h2>
        <p>This quiz consists of 30 multiple-choice questions based on angle relationships, transversals, triangles, and similarity.</p>
        <p><strong>Time Limit: 45 Minutes</strong></p>
        <button type="button" class="btn-main" id="start-btn" onclick="startQuiz()">Start Quiz Now</button>
    </div>

    <div id="quiz-screen">
        <div class="timer-header">
            <span>Unit 8 Assessment</span>
            <span id="time-display" aria-live="polite">45:00</span>
        </div>
        
        <div id="results">
            <div id="results-text"></div>
            <button type="button" class="btn-main" id="retake-btn" onclick="restartQuiz()" style="font-size: 0.8em; margin-top: 15px;">Retake Assessment</button>
        </div>
        
        <div id="quiz-body"></div>
        
        <div style="text-align: center; margin-top: 30px;">
            <button type="button" class="btn-main" id="submit-btn" onclick="submitQuiz()">Submit Answers</button>
        </div>
    </div>
</div>

<script>
    // --- SVG BLUEPRINTS ---
    const svgAngleBasics = `<svg width="300" height="200" viewBox="0 0 300 200">
        <line x1="20" y1="100" x2="280" y2="100" stroke="black" stroke-width="2"/>
        <line x1="150" y1="180" x2="150" y2="20" stroke="black" stroke-width="2"/>
        <line x1="150" y1="100" x2="250" y2="40" stroke="black" stroke-width="2"/>
        <rect x="135" y="85" width="15" height="15" fill="none" stroke="black"/>
        <text x="10" y="105" font-size="14">A</text>
        <text x="145" y="15" font-size="14">B</text>
        <text x="255" y="35" font-size="14">C</text>
        <text x="285" y="105" font-size="14">D</text>
        <text x="145" y="195" font-size="14">E</text>
        <text x="155" y="115" font-size="14">X</text>
    </svg>`;

    const svgQ4 = `<svg width="250" height="120" viewBox="0 0 250 120">
        <defs><marker id="arrow-q4" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="black" /></marker></defs>
        <line x1="20" y1="90" x2="230" y2="90" stroke="black" stroke-width="2" marker-end="url(#arrow-q4)" marker-start="url(#arrow-q4)"/>
        <line x1="125" y1="90" x2="70" y2="20" stroke="black" stroke-width="2" marker-end="url(#arrow-q4)"/>
        <text x="60" y="80" font-size="14">60°</text>
        <text x="140" y="80" font-size="14">(5x + 5)°</text>
    </svg>`;

    const svgQ5 = `<svg width="250" height="150" viewBox="0 0 250 150">
        <defs><marker id="arrow-q5" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="black" /></marker></defs>
        <line x1="40" y1="120" x2="210" y2="30" stroke="black" stroke-width="2" marker-end="url(#arrow-q5)" marker-start="url(#arrow-q5)"/>
        <line x1="20" y1="75" x2="230" y2="75" stroke="black" stroke-width="2" marker-end="url(#arrow-q5)" marker-start="url(#arrow-q5)"/>
        <text x="135" y="65" font-size="14">50°</text>
        <text x="75" y="105" font-size="14">(2x + 25)°</text>
    </svg>`;

    const svgQ6 = `<svg width="200" height="200" viewBox="0 0 200 200">
        <defs><marker id="arrow-q6" markerWidth="10" markerHeight="10" refX="5" refY="5" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="black" /></marker></defs>
        <line x1="30" y1="170" x2="180" y2="170" stroke="black" stroke-width="2" marker-end="url(#arrow-q6)"/>
        <line x1="30" y1="170" x2="30" y2="20" stroke="black" stroke-width="2" marker-end="url(#arrow-q6)"/>
        <line x1="30" y1="170" x2="130" y2="70" stroke="black" stroke-width="2" marker-end="url(#arrow-q6)"/>
        <rect x="30" y="150" width="20" height="20" fill="none" stroke="black"/>
        <text x="60" y="155" font-size="14">39°</text>
        <text x="45" y="100" font-size="14">(5x - 1)°</text>
    </svg>`;

    const svgTransversal = `<svg width="300" height="160" viewBox="0 0 300 160">
        <line x1="30" y1="60" x2="270" y2="60" stroke="black" stroke-width="2"/>
        <line x1="30" y1="110" x2="270" y2="110" stroke="black" stroke-width="2"/>
        <line x1="80" y1="150" x2="220" y2="20" stroke="black" stroke-width="2"/>
        <text x="180" y="50" font-size="14">1</text>
        <text x="210" y="50" font-size="14">2</text>
        <text x="155" y="80" font-size="14">3</text>
        <text x="190" y="80" font-size="14">4</text>
        <text x="130" y="100" font-size="14">5</text>
        <text x="160" y="100" font-size="14">6</text>
        <text x="105" y="130" font-size="14">7</text>
        <text x="140" y="130" font-size="14">8</text>
    </svg>`;

    const svgParallelogram = `<svg width="300" height="130" viewBox="0 0 300 130">
        <polygon points="100,100 240,100 280,30 140,30" fill="none" stroke="black" stroke-width="2"/>
        <line x1="50" y1="100" x2="100" y2="100" stroke="black" stroke-width="2"/>
        <path d="M 80 100 A 20 20 0 0 1 85 85" fill="none" stroke="black"/>
        <text x="60" y="95" font-size="14">78°</text>
        <text x="115" y="90" font-size="14">x</text>
        <text x="250" y="50" font-size="14">y</text>
        <text x="220" y="90" font-size="14">z</text>
    </svg>`;

    const svgQ13 = `<svg width="220" height="120" viewBox="0 0 220 120">
        <line x1="20" y1="100" x2="200" y2="20" stroke="black" stroke-width="2"/>
        <line x1="40" y1="20" x2="180" y2="100" stroke="black" stroke-width="2"/>
        <text x="45" y="65" font-size="14">63°</text>
        <text x="120" y="65" font-size="14">(4x - 3)°</text>
    </svg>`;

    const svgQ38 = `<svg width="250" height="150" viewBox="0 0 250 150">
        <polygon points="40,20 40,130 220,130" fill="none" stroke="black" stroke-width="2"/>
        <line x1="160" y1="93" x2="160" y2="130" stroke="black" stroke-width="2"/>
        <rect x="40" y="115" width="15" height="15" fill="none" stroke="black"/>
        <rect x="145" y="115" width="15" height="15" fill="none" stroke="black"/>
        <text x="15" y="80" font-size="14">9 cm</text>
        <text x="120" y="115" font-size="14">3 cm</text>
        <text x="175" y="145" font-size="14">4 cm</text>
        <text x="30" y="15" font-size="14">P</text>
        <text x="30" y="145" font-size="14">Q</text>
        <text x="150" y="145" font-size="14">S</text>
        <text x="165" y="85" font-size="14">R</text>
        <text x="225" y="145" font-size="14">T</text>
    </svg>`;

    // --- QUIZ DATA ---
    const quizData = [
        { q: "Use the Angle Basics figure. Identify the vertical angle to Angle AXE.", diagram: svgAngleBasics, correct: "Angle BXD", distractors: ["Angle CXD", "Angle AXB", "Angle BXC"] },
        { q: "Use the Angle Basics figure. Identify the angle that forms a linear pair with Angle AXC.", diagram: svgAngleBasics, correct: "Angle DXC", distractors: ["Angle BXC", "Angle AXE", "Angle BXA"] },
        { q: "Use the Angle Basics figure. Identify the angle that forms a linear pair with Angle BXD.", diagram: svgAngleBasics, correct: "Angle AXB", distractors: ["Angle BXC", "Angle CXD", "Angle AXC"] },
        
        { q: "Identify the angle relationship and solve for x.", diagram: svgQ4, correct: "Supplementary; x = 23", distractors: ["Complementary; x = 5", "Vertical; x = 23", "Supplementary; x = 115"] },
        { q: "Identify the angle relationship and solve for x.", diagram: svgQ5, correct: "Vertical; x = 12.5", distractors: ["Supplementary; x = 52.5", "Corresponding; x = 12.5", "Vertical; x = 25"] },
        { q: "Identify the angle relationship and solve for x.", diagram: svgQ6, correct: "Complementary; x = 10.4", distractors: ["Supplementary; x = 28.4", "Vertical; x = 8", "Complementary; x = 52"] },
        
        { q: "Angle 1 and Angle 8 are alternate exterior angles. If Angle 1 = 155°, what is Angle 8?", diagram: svgTransversal, correct: "155°", distractors: ["25°", "90°", "180°"] },
        { q: "Angle 2 and Angle 6 are corresponding angles. If Angle 2 = 43°, what is Angle 6?", diagram: svgTransversal, correct: "43°", distractors: ["137°", "47°", "90°"] },
        { q: "Angle 5 and Angle 8 are vertical angles. If Angle 5 = 121°, what is Angle 8?", diagram: svgTransversal, correct: "121°", distractors: ["59°", "180°", "69°"] },
        { q: "Angle 3 and Angle 6 are alternate interior angles. If Angle 3 = 38°, what is Angle 6?", diagram: svgTransversal, correct: "38°", distractors: ["142°", "52°", "90°"] },
        { q: "Angle 7 and Angle 8 are supplementary angles. If Angle 7 = 35°, what is Angle 8?", diagram: svgTransversal, correct: "145°", distractors: ["35°", "55°", "180°"] },
        
        { q: "In the parallelogram, find the measure of angle x.", diagram: svgParallelogram, correct: "102°", distractors: ["78°", "180°", "204°"] },
        { q: "In the parallelogram, find the measure of angle y.", diagram: svgParallelogram, correct: "78°", distractors: ["102°", "90°", "180°"] },
        { q: "In the parallelogram, find the measure of angle z.", diagram: svgParallelogram, correct: "102°", distractors: ["78°", "180°", "204°"] },
        
        { q: "Angle Relationship: Vertical. Write and solve an equation for x if the angles are 63° and (4x - 3)°.", diagram: svgQ13, correct: "x = 16.5", distractors: ["x = 15", "x = 12.5", "x = 66"] },
        { q: "Angle Relationship: Alternate Interior. Write and solve an equation for x if the angles are 61° and (6x + 1)°.", diagram: "", correct: "x = 10", distractors: ["x = 12", "x = 60", "x = 11"] },
        { q: "Angle Relationship: Corresponding. Write and solve an equation for x if the angles are 110° and (2 + 4x)°.", diagram: "", correct: "x = 27", distractors: ["x = 28", "x = 108", "x = 27.5"] },
        { q: "Angle Relationship: Alternate Exterior. Write and solve an equation for x if the angles are 78° and (4x + 2)°.", diagram: "", correct: "x = 19", distractors: ["x = 20", "x = 76", "x = 18.5"] },
        
        { q: "Can the side lengths 6, 4, 7 create a triangle?", diagram: "", correct: "Yes", distractors: ["No", "Only if it is a right triangle", "Only if equilateral"] },
        { q: "Can the side lengths 10, 20, 2 create a triangle?", diagram: "", correct: "No", distractors: ["Yes", "Only if it is isosceles", "Only if acute"] },
        { q: "Can the side lengths 2, 5, 9 create a triangle?", diagram: "", correct: "No", distractors: ["Yes", "Only if it is a right triangle", "Only if obtuse"] },
        { q: "Can the side lengths 11, 4, 7 create a triangle?", diagram: "", correct: "No", distractors: ["Yes", "Only if scalene", "Only if acute"] },
        
        { q: "Is a triangle whose exterior angles are 30°, 60°, 90° possible?", diagram: "", correct: "No", distractors: ["Yes", "Only if it is a right triangle", "Only if equilateral"] },
        { q: "Is a triangle with 3 acute angles possible?", diagram: "", correct: "Yes", distractors: ["No", "Only if the sum is 360°", "Only if isosceles"] },
        { q: "Is a triangle with 1 obtuse angle, 1 right angle, and 1 acute angle possible?", diagram: "", correct: "No", distractors: ["Yes", "Only if the acute angle is 45°", "Only if scalene"] },
        { q: "Is a triangle with 2 right angles possible?", diagram: "", correct: "No", distractors: ["Yes", "Only on a flat plane", "Only if the third angle is obtuse"] },
        { q: "Is a triangle whose interior angles are 45°, 45°, 45° possible?", diagram: "", correct: "No", distractors: ["Yes", "Only if side lengths are equal", "Only if it is an isosceles right triangle"] },
        
        { q: "Determine if triangles with side lengths (15, 7, 10) and (45, 21, 30) are similar.", diagram: "", correct: "Yes, by SSS Similarity (scale factor of 3)", distractors: ["No, ratios are not equal", "Yes, by AA Similarity", "Yes, by SAS Similarity"] },
        { q: "Rose is 64 inches tall and her shadow is 40 inches long. A flag pole casts a 50-inch shadow. Find the flag pole's height.", diagram: "", correct: "80 inches", distractors: ["100 inches", "31.25 inches", "72 inches"] },
        { q: "Find the length of QS using the given similar right triangles.", diagram: svgQ38, correct: "8 cm", distractors: ["12 cm", "6 cm", "10 cm"] }
    ];

    const quizBody = document.getElementById('quiz-body');
    let userAnswers = [];
    let timerInterval;
    let timeLeft = 45 * 60; // 45 minutes

    // --- LOGIC ---
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function startQuiz() {
        clearInterval(timerInterval); // Prevents multiple instances
        document.getElementById('start-btn').disabled = true; // Guard against double clicks
        
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        document.getElementById('results').style.display = 'none';
        
        const submitBtn = document.getElementById('submit-btn');
        submitBtn.style.display = 'inline-block';
        submitBtn.disabled = false; // Reset submit button state
        
        renderQuiz();
        startTimer();
    }
    
    function restartQuiz() {
        clearInterval(timerInterval);
        document.getElementById('start-btn').disabled = false;
        startQuiz();
    }

    function startTimer() {
        timeLeft = 45 * 60;
        const timeDisplay = document.getElementById('time-display');
        
        updateTimeDisplay(timeDisplay);
        
        timerInterval = setInterval(() => {
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                submitQuiz();
            } else {
                timeLeft--;
                updateTimeDisplay(timeDisplay);
            }
        }, 1000);
    }
    
    function updateTimeDisplay(element) {
        const minutes = Math.floor(timeLeft / 60).toString().padStart(2, '0');
        const seconds = (timeLeft % 60).toString().padStart(2, '0');
        element.innerText = `${minutes}:${seconds}`;
    }

    function renderQuiz() {
        quizBody.innerHTML = '';
        userAnswers = new Array(quizData.length).fill(null);
        
        quizData.forEach((item, index) => {
            let options = [item.correct, ...item.distractors];
            options = shuffleArray(options);

            const qBlock = document.createElement('div');
            qBlock.className = 'question-block';
            qBlock.id = `q-${index}`;

            let htmlString = `<div class="question-text">${index + 1}. ${item.q}</div>`;
            if (item.diagram) {
                htmlString += `<div class="diagram-container">${item.diagram}</div>`;
            }
            qBlock.innerHTML = htmlString;
            
            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'options-grid';
            
            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.type = 'button'; 
                btn.className = 'option-btn';
                btn.dataset.value = opt; 
                btn.innerText = opt; 
                
                btn.addEventListener('click', function() {
                    userAnswers[index] = this.dataset.value;
                    const siblings = this.parentElement.children;
                    for (let sibling of siblings) {
                        sibling.classList.remove('selected');
                    }
                    this.classList.add('selected');
                });
                
                optionsContainer.appendChild(btn);
            });

            qBlock.appendChild(optionsContainer);
            quizBody.appendChild(qBlock);
        });
    }

    function submitQuiz() {
        const submitBtn = document.getElementById('submit-btn');
        if (submitBtn.disabled) return; // Double click guard
        
        clearInterval(timerInterval);
        submitBtn.disabled = true;
        submitBtn.style.display = 'none';
        
        let score = 0;
        quizData.forEach((item, index) => {
            const block = document.getElementById(`q-${index}`);
            const buttons = block.querySelectorAll('.option-btn');
            
            buttons.forEach(btn => {
                btn.disabled = true; 
                const btnValue = btn.dataset.value;
                
                if (btnValue === item.correct) {
                    btn.classList.add('correct');
                } else if (btn.classList.contains('selected') && btnValue !== item.correct) {
                    btn.classList.add('incorrect');
                }
            });

            if (userAnswers[index] === item.correct) {
                score++;
            }
        });

        const resultsDiv = document.getElementById('results');
        const resultsText = document.getElementById('results-text');
        resultsDiv.style.display = 'block';
        
        const percentage = Math.round((score / quizData.length) * 100);
        
        if(percentage >= 80) {
            resultsDiv.style.backgroundColor = "#e8f8f5";
            resultsDiv.style.color = "var(--correct-color)";
            resultsDiv.style.border = "2px solid var(--correct-color)";
        } else {
            resultsDiv.style.backgroundColor = "#fdedec";
            resultsDiv.style.color = "var(--incorrect-color)";
            resultsDiv.style.border = "2px solid var(--incorrect-color)";
        }
        
        resultsText.innerHTML = `Assessment Complete!<br>Final Score: ${score} / ${quizData.length} (${percentage}%)<br><span class="results-subtext">Review your answers below. Correct answers are highlighted in green.</span>`;
        
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>

</body>
</html>
